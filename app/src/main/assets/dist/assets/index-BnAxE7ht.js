import{d as _,j as Y,k as z,r as c,l as B,o as b,c as C,a as f,m as N,h as d,b as y,_ as O,n as P,p as R,w as S,g as $,i as v,s as T,q as U,t as E,v as V,x as g,y as j,z as h,e as k}from"./index-5kp1FiRg.js";import{_ as A}from"./AccSearchForm.vue_vue_type_script_setup_true_lang-Dhb4mZkZ.js";import{u as q,E as x}from"./useSystemTheme-lyMPqukv.js";import{u as I,i as F,a as G,b as M,c as H,d as J}from"./install-CoVyZzHx.js";import{i as K}from"./install-DOWDe9Pp.js";import{i as Q}from"./install-8Xh6dgN5.js";import{i as W}from"./install-BO7C1UUT.js";import{u as X}from"./useTabsListener-CnvSNM1v.js";import"./config-BiPkORWZ.js";import"./index-BpTLWCN6.js";import"./createSeriesDataSimply-BFEE_GIw.js";const w=_({__name:"InvestList",props:{type:{}},setup(m){const t=m,a=Y();async function i({pageNum:u,form:o}){var r;const l=await P({page:u,type:t.type,...o});return{total:Number((r=l==null?void 0:l.data)==null?void 0:r.length),data:l.data}}const{routerPush:p}=z(),s=c({value:"",detailed_id:"",page_size:30,visit_eid:0});function e(){p(t.type==="1"?"safeAdd":"envAdd",{type:t.type})}const n=B([{icon:"search",key:"search"}]);function D(u){p(t.type==="1"?"safeDetail":"envDetail",u)}const L=[{title:"年度",key:"year",width:"20%",align:"center"},{title:"费用项目",key:"cost_name",width:t.type==="2"?"50%":"30%"},{title:"计划金额",key:"plan_total",width:"20%",align:"right",hidden:t.type==="2"},{title:"实投金额",key:"actual_total",width:"20%",align:"right"}];return b(()=>{t.type==="1"&&(a!=null&&a.getPri("invest",1))?n.unshift({icon:"add",key:"add",onClick:()=>{e()}}):a!=null&&a.getPri("envi-invest-edit",0)&&n.unshift({icon:"add",key:"add",onClick:()=>{e()}})}),(u,o)=>{const l=O;return f(),C(l,{form:s.value,"onUpdate:form":o[1]||(o[1]=r=>s.value=r),columns:L,request:i,floating:y(n),onOnRowClick:D},{searchForm:N(()=>[d(A,{form:s.value,"onUpdate:form":o[0]||(o[0]=r=>s.value=r),"data-key":{set_etp_id:"set_etp_id",year:"value",expense_name:"detailed_id",type:m.type}},null,8,["form","data-key"])]),_:1},8,["form","floating"])}}}),Z=_({__name:"Statistics",setup(m){q();const t=c({Y:R().year().toString()});I([F,K,Q,W,G,M,H,J]);const a=c({tooltip:{trigger:"item"},legend:{},series:[{name:"",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10}}]}),i=c({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},yAxis:{type:"value",boundaryGap:[0,.01]},xAxis:{type:"category",data:[]},series:[{name:"实投",type:"bar",stack:"总量",data:Array.from({length:12}).fill(0).map(s=>0)},{name:"计划",type:"bar",stack:"总量",data:Array.from({length:12}).fill(0).map(s=>0)}]});function p(){T({message:"加载中...",forbidClick:!0}),U({Y:t.value.Y,mark:1}).then(s=>{var e;E(),i.value.xAxis.data=(e=s.month.header)==null?void 0:e.map(n=>n.split("-")[1]),i.value.series[0].data=s.month.data[0].data,i.value.series[1].data=s.month.data[1].data})}return b(()=>{p()}),S(()=>t.value.Y,()=>{p()}),(s,e)=>(f(),$("div",null,[e[1]||(e[1]=v("div",{class:"title"}," 投入项目构成统计 ",-1)),d(A,{form:t.value,"onUpdate:form":e[0]||(e[0]=n=>t.value=n),"data-key":{year:"Y"}},null,8,["form"]),d(y(x),{class:"chart",option:a.value,autoresize:""},null,8,["option"]),e[2]||(e[2]=v("div",{class:"title"}," 投入/计划比 ",-1)),d(y(x),{class:"chart",option:i.value,autoresize:""},null,8,["option"])]))}}),tt=V(Z,[["__scopeId","data-v-cf50757e"]]),et={class:"flex-center w-100% items-center"},at=_({__name:"index",setup(m){const t=c("safe");return X("invest-click-tab",a=>{t.value=a.name}),(a,i)=>(f(),$("div",et,[g(d(w,{type:"1"},null,512),[[h,t.value==="safe"]]),g(d(w,{type:"2"},null,512),[[h,t.value==="env"]]),t.value==="statistics"?(f(),C(tt,{key:0})):j("",!0)]))}});typeof k=="function"&&k(at);export{at as default};
