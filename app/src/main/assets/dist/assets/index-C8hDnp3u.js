import{aB as G,d as me,l as _e,j as Z,w as fe,r as i,o as j,g as w,a as c,F as ve,c as V,y as R,b as k,G as ye,$ as ge,U as be,v as Y,ay as E,h as t,i as l,m as n,aY as Q,aZ as W,ad as v,_ as X,I as ee,aq as te,a2 as ne,H as ae,J as K,aj as J,ae as he,aG as O,a6 as ke,e as ue}from"./index-5kp1FiRg.js";import{u as we}from"./useTabsListener-CnvSNM1v.js";import{u as oe}from"./useTaskProcessClick-D9hNHbDn.js";import{D as se}from"./Detail-CBGWh8FM.js";import{a as xe}from"./index-BpTLWCN6.js";/* empty css                                                               */async function ie(m){return G.get("/message/get_list",{params:m})}async function de(m){return G.get("/message/get_send_list",{params:m})}async function re(m){return G.get("/message/get_info",{params:m})}async function Ce(m){return G.get("/enemergency/notification_list",{params:m})}const le=me({__name:"SearchForm",props:{form:{},dataKey:{}},emits:["update:form"],setup(m,{emit:g}){const C=m,S=g,o=_e({...C.form}),_=Z();fe(o,$=>{S("update:form",$)},{deep:!0});const b=i([{text:"正向",value:1},{text:"负向",value:0}]),x=i([]),f=i({label:"title",value:"node_id",children:"child"});async function u(){const{etp_id:$}=_.userInfo,y=await xe({id:$,deep:2,enbase:1,is_node:1});x.value=[{title:"全部",node_id:"all",child:y||[]}]}return j(()=>{u()}),($,y)=>{const B=ye,T=ge,z=be;return c(),w(ve,null,[m.dataKey.content?(c(),V(B,{key:0,modelValue:k(o).content,"onUpdate:modelValue":y[0]||(y[0]=h=>k(o).content=h),type:"text",name:"text",label:"",placeholder:"消息内容",clearable:""},null,8,["modelValue"])):R("",!0),m.dataKey.dept?(c(),V(T,{key:1,"model-value":k(o).department_id,options:x.value,"field-names":f.value,placeholder:"请选择部门","onUpdate:modelValue":y[1]||(y[1]=h=>{var U;return k(o).department_id=(U=h==null?void 0:h[0])==null?void 0:U.value})},null,8,["model-value","options","field-names"])):R("",!0),m.dataKey.money_type?(c(),V(z,{key:2,value:k(o).money_type,"onUpdate:value":y[2]||(y[2]=h=>k(o).money_type=h),columns:b.value,label:"",placeholder:"请选择激励类型"},null,8,["value","columns"])):R("",!0)],64)}}}),$e=["onClick"],De={class:"text-13px mb-10px"},Se={class:"break-words"},Te={class:"text-13px mb-10px text-center break-words"},Ue={class:"text-13px mb-5px text-left break-words"},Ne={style:{padding:"10px",display:"flex"}},Ie={__name:"myMessage",setup(m,{expose:g}){const{handleRowClick:C}=oe(),S=Z(),o=i(!0),_=i(void 0),b=i(!1),x=i([]),f=i(!1),u=i({page:1,del:0,msgtype:"",begin_time:"",end_time:"",sender:"",ename:"",types:0,content:""});function $(r){return r?r.split(","):[]}function y(r){re({message_id:r.id}).then(e=>{x.value=[{label:"".concat(o.value?"Form":"To"),value:e.data[0].send_name},{label:"发送时间",value:e.data[0].created_at},{label:"消息内容",value:e.data[0].content,renderType:"html"},{label:"附件",value:$(e.data[0].annex),renderType:"files"}],b.value=!0})}function B(){C({key:"add"},{type:(o.value,1)})}function T(){o.value=!o.value,_.value.loadData(!0)}async function z({pageNum:r}={pageNum:1}){let e={};const a={...u.value,page:r};return o.value?e=await ie(a):e=await de(a),{total:Number(e.count)||0,pageNum:r,data:(e.list||[]).map(d=>({staffNmame:d.send_user_name,date:d.created_at,content:d.content,id:d.id}))}}function h(){_.value.loadData(!0)}function U(){f.value=!0}function N(){f.value=!1}function L(){u.value={page:1,del:0,msgtype:"",begin_time:"",end_time:"",sender:"",ename:"",types:0,content:""}}async function A(){await J(),_.value.loadData(!0),N()}return j(()=>{}),E(()=>{}),g({fresh:h}),(r,e)=>{var I;const a=W,d=Q,F=X,D=ee,M=te,P=ae,q=ne;return c(),w("div",null,[t(F,{ref_key:"listRef",ref:_,form:u.value,"onUpdate:form":e[0]||(e[0]=s=>u.value=s),request:z},{row:n(({item:s,index:H})=>[(c(),w("div",{key:H,class:"item p-10px",onClick:p=>y(s)},[t(d,{class:"p-10px bg-white"},{default:n(()=>[t(a,{span:"24"},{default:n(()=>[t(d,null,{default:n(()=>[t(a,{span:"12",class:"!p-0"},{default:n(()=>[l("div",De,[l("span",null,v(o.value?"发送人":"接收人")+"：",1),l("span",Se,v(s.staffNmame||"-"),1)])]),_:2},1024),t(a,{span:"12",class:"!p-0"},{default:n(()=>[l("div",Te,v(s.date||"-"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(a,{span:"24"},{default:n(()=>[l("div",Ue,v(s.content||"-"),1)]),_:2},1024)]),_:2},1024)],8,$e))]),_:1},8,["form"]),l("div",{class:"maill-btn",onClick:T},v(o.value?"发":"收"),1),(I=k(S))!=null&&I.getPri("message-list",1)?(c(),w("div",{key:0,class:"add-plus",onClick:B},[t(D,{name:"plus",size:"30"})])):R("",!0),l("div",{class:"search-btn",onClick:U},[t(D,{name:"search",size:"30"})]),t(M,{show:b.value,"onUpdate:show":e[1]||(e[1]=s=>b.value=s),position:"bottom",style:{height:"70%"}},{default:n(()=>[t(se,{items:x.value},null,8,["items"])]),_:1},8,["show"]),t(M,{show:f.value,"onUpdate:show":e[3]||(e[3]=s=>f.value=s),position:"bottom",onClose:N},{default:n(()=>[t(q,{onSubmit:A},{default:n(()=>[t(le,{form:u.value,"onUpdate:form":e[2]||(e[2]=s=>u.value=s),"data-key":{sender:"sender",content:"content"}},null,8,["form"]),l("div",Ne,[t(P,{round:"",block:"","native-type":"reset",style:{"margin-right":"8px"},onClick:L},{default:n(()=>[...e[4]||(e[4]=[K(" 重置 ",-1)])]),_:1}),t(P,{round:"",block:"",type:"primary","native-type":"submit"},{default:n(()=>[...e[5]||(e[5]=[K(" 查询 ",-1)])]),_:1})])]),_:1})]),_:1},8,["show"])])}}},Re=Y(Ie,[["__scopeId","data-v-3238e075"]]),Be={class:"notification-container"},ze=["onClick"],Fe={class:"title"},Me={class:"info"},Pe={class:"info"},Ve={class:"theme"},qe={key:1},He={style:{padding:"10px",display:"flex"}},Ke={__name:"tongbao",setup(m,{expose:g}){const{handleRowClick:C}=oe(),S=Z(),o=i(!0),_=i(void 0),b=i(!1),x=i([]),f=i(!1),u=i({money_type:"",page:1,field:"",department_id:"",start_date:"",end_date:"",send_uid:0});function $(){o.value=!o.value,u.value.page=1,u.value.send_uid=o.value?0:1,_.value.loadData(!0)}function y(){C({key:"add"},{type:(o.value,1)})}function B(e){const a=e.files.split(",")[0];window.open(a)}function T(e){return Number(e.money_type)>0?"+".concat(e.money):"-".concat(e.money)}async function z({pageNum:e}={pageNum:1}){const a=await Ce({...u.value,page:e});return{total:Number(a.count)||0,data:a.data||[]}}function h(){_.value.loadData(!0)}function U(){f.value=!0}function N(){f.value=!1}function L(){u.value={money_type:"",page:1,field:"",department_id:"",start_date:"",end_date:"",send_uid:0}}async function A(){await J(),_.value.loadData(!0),N()}function r(e){x.value=[{label:"通知主题",value:e.theme},{label:"时间",value:e.date},{label:"授信部门",value:e.department},{label:"激励金额",value:T(e)},{label:"激励类型",value:Number(e.money_type)>0?"正向":"负向"},{label:"通知正文",value:e.theme_content},{label:"通知备注",value:e.remarks},{label:"附件",value:e.files,renderType:"image"}],b.value=!0}return j(()=>{}),E(()=>{}),g({fresh:h}),(e,a)=>{var H;const d=W,F=Q,D=ee,M=X,P=se,q=te,I=ae,s=ne;return c(),w("div",Be,[t(M,{ref_key:"listRef",ref:_,request:z},{row:n(({item:p,index:ce})=>[(c(),w("div",{key:ce,class:"item",onClick:pe=>r(p)},[t(F,null,{default:n(()=>[t(d,{span:"24"},{default:n(()=>[l("div",Fe,v(p.etp_id_name),1)]),_:2},1024)]),_:2},1024),t(F,null,{default:n(()=>[t(d,{span:"12"},{default:n(()=>[l("div",Me,[a[3]||(a[3]=l("span",null,"授信部门：",-1)),l("span",null,v(p.department),1)])]),_:2},1024),t(d,{span:"12",class:"text-center"},{default:n(()=>[l("div",Pe,[l("span",null,v(p.date),1)])]),_:2},1024)]),_:2},1024),t(F,null,{default:n(()=>[t(d,{span:"20"},{default:n(()=>[l("div",Ve,v(p.theme),1),l("div",{class:he(["money",{credit:p.money_type>0,debit:p.money_type<=0}])},v(T(p)),3)]),_:2},1024),t(d,{span:"4",class:"text-center"},{default:n(()=>[p.files?(c(),V(D,{key:0,name:"description",size:"30",onClick:pe=>B(p)},null,8,["onClick"])):(c(),w("div",qe,"-"))]),_:2},1024)]),_:2},1024)],8,ze))]),_:1},512),l("div",{class:"switch-btn",onClick:$},v(o.value?"全":"我"),1),(H=k(S))!=null&&H.getPri("bulletin",1)?(c(),w("div",{key:0,class:"add-plus",onClick:y},[t(D,{name:"plus",size:"30"})])):R("",!0),l("div",{class:"search-btn",onClick:U},[t(D,{name:"search",size:"30"})]),t(q,{show:b.value,"onUpdate:show":a[0]||(a[0]=p=>b.value=p),position:"bottom",style:{height:"70%"}},{default:n(()=>[t(P,{items:x.value},null,8,["items"])]),_:1},8,["show"]),t(q,{show:f.value,"onUpdate:show":a[2]||(a[2]=p=>f.value=p),position:"bottom",onClose:N},{default:n(()=>[t(s,{onSubmit:A},{default:n(()=>[t(le,{form:u.value,"onUpdate:form":a[1]||(a[1]=p=>u.value=p),"data-key":{money_type:"money_type",dept:"dept"}},null,8,["form"]),l("div",He,[t(I,{round:"",block:"","native-type":"reset",style:{"margin-right":"8px"},onClick:L},{default:n(()=>[...a[4]||(a[4]=[K(" 重置 ",-1)])]),_:1}),t(I,{round:"",block:"",type:"primary","native-type":"submit"},{default:n(()=>[...a[5]||(a[5]=[K(" 查询 ",-1)])]),_:1})])]),_:1})]),_:1},8,["show"])])}}},Le=Y(Ke,[["__scopeId","data-v-ac9f4d5e"]]),Ae=["onClick"],je={class:"text-13px mb-10px"},Ge={class:"break-words"},Ze={class:"text-13px mb-10px text-center break-words"},Ee={class:"text-13px mb-5px text-left break-words"},Je={style:{padding:"10px",display:"flex"}},Oe={__name:"tongzhi",setup(m,{expose:g}){const{handleRowClick:C}=oe(),S=Z(),o=i(!0),_=i(void 0),b=i(!1),x=i([]),f=i(!1),u=i({del:0,msgtype:"",begin_time:"",end_time:"",sender:"",ename:"",types:1,content:""});function $(r){return r?r.split(","):[]}function y(r){re({message_id:r.id}).then(e=>{x.value=[{label:"".concat(o.value?"Form":"To"),value:e.data[0].send_name},{label:"发送时间",value:e.data[0].created_at},{label:"消息内容",value:e.data[0].content,renderType:"html"},{label:"附件",value:$(e.data[0].annex),renderType:"files"}],b.value=!0})}function B(){C({key:"add"},{type:(o.value,1)})}function T(){o.value=!o.value,_.value.loadData(!0)}async function z({pageNum:r}={pageNum:1}){let e={};const a={...u.value,page:r};return o.value?e=await ie(a):e=await de(a),{total:Number(e.count)||0,pageNum:r,data:(e.list||[]).map(d=>({staffNmame:d.send_user_name,date:d.created_at,content:d.content,id:d.id}))}}function h(){_.value.loadData(!0)}function U(){f.value=!0}function N(){f.value=!1}function L(){u.value={page:1,del:0,msgtype:"",begin_time:"",end_time:"",sender:"",ename:"",types:0,content:""}}async function A(){await J(),_.value.loadData(!0),N()}return j(()=>{}),E(()=>{}),g({fresh:h}),(r,e)=>{var I;const a=W,d=Q,F=X,D=ee,M=te,P=ae,q=ne;return c(),w("div",null,[t(F,{ref_key:"listRef",ref:_,form:u.value,"onUpdate:form":e[0]||(e[0]=s=>u.value=s),request:z},{row:n(({item:s,index:H})=>[(c(),w("div",{key:H,class:"item p-10px",onClick:p=>y(s)},[t(d,{class:"p-10px bg-white"},{default:n(()=>[t(a,{span:"24"},{default:n(()=>[t(d,null,{default:n(()=>[t(a,{span:"12",class:"!p-0"},{default:n(()=>[l("div",je,[l("span",null,v(o.value?"发送人":"接收人")+"：",1),l("span",Ge,v(s.staffNmame||"-"),1)])]),_:2},1024),t(a,{span:"12",class:"!p-0"},{default:n(()=>[l("div",Ze,v(s.date||"-"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(a,{span:"24"},{default:n(()=>[l("div",Ee,v(s.content||"-"),1)]),_:2},1024)]),_:2},1024)],8,Ae))]),_:1},8,["form"]),l("div",{class:"maill-btn",onClick:T},v(o.value?"发":"收"),1),(I=k(S))!=null&&I.getPri("message-list-zh",1)?(c(),w("div",{key:0,class:"add-plus",onClick:B},[t(D,{name:"plus",size:"30"})])):R("",!0),l("div",{class:"search-btn",onClick:U},[t(D,{name:"search",size:"30"})]),t(M,{show:b.value,"onUpdate:show":e[1]||(e[1]=s=>b.value=s),position:"bottom",style:{height:"70%"}},{default:n(()=>[t(se,{items:x.value},null,8,["items"])]),_:1},8,["show"]),t(M,{show:f.value,"onUpdate:show":e[3]||(e[3]=s=>f.value=s),position:"bottom",onClose:N},{default:n(()=>[t(q,{onSubmit:A},{default:n(()=>[t(le,{form:u.value,"onUpdate:form":e[2]||(e[2]=s=>u.value=s),"data-key":{sender:"sender",content:"content"}},null,8,["form"]),l("div",Je,[t(P,{round:"",block:"","native-type":"reset",style:{"margin-right":"8px"},onClick:L},{default:n(()=>[...e[4]||(e[4]=[K(" 重置 ",-1)])]),_:1}),t(P,{round:"",block:"",type:"primary","native-type":"submit"},{default:n(()=>[...e[5]||(e[5]=[K(" 查询 ",-1)])]),_:1})])]),_:1})]),_:1},8,["show"])])}}},Ye=Y(Oe,[["__scopeId","data-v-6d8bccf5"]]),Qe={class:"absolute inset-0"},We={__name:"index",setup(m){let g=i("myMsg");return we("message-click-tab",C=>{g.value=C.name}),j(()=>{O(),J(()=>{g.value="myMsg"})}),E(()=>{O()}),ke(()=>{O()}),(C,S)=>(c(),w("div",Qe,[k(g)==="myMsg"?(c(),V(Re,{key:0,ref:"myMsgRef"},null,512)):R("",!0),k(g)==="tongzhi"?(c(),V(Ye,{key:1,ref:"TZRef"},null,512)):k(g)==="tongbao"?(c(),V(Le,{key:2,ref:"TBRef"},null,512)):R("",!0)]))}};typeof ue=="function"&&ue(We);export{We as default};
