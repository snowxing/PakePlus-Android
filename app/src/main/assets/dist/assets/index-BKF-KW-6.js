import{u as E}from"./useTabsListener-CnvSNM1v.js";import{v as g,r as a,o as x,aj as I,aC as L,g as u,a as c,y as k,i as h,h as S,m as D,J as $,a$ as O,d as N,c as z,b as C,e as W}from"./index-5kp1FiRg.js";import"./index-1VOhhtK2.js";import{g as T,a as V,b as A}from"./riskStats-Dzm-5IK9.js";import{e as y}from"./install-CoVyZzHx.js";import"./install-8Xh6dgN5.js";import"./install-BO7C1UUT.js";import"./install-DOWDe9Pp.js";import"./createSeriesDataSimply-BFEE_GIw.js";import"./install-QPGF1BwB.js";import"./install-neqUmNW9.js";const P={class:"stats-card"},j={key:0,class:"loading-container"},J={__name:"DepartmentStats",setup(w){a("");const t=a(!0),i=a(null);a(null);let o=null;const e=a({season:[],set_etp_id:"",level:""}),n=()=>{o==null||o.resize()},_=async()=>{try{t.value=!0;const l=await T(e.value);o=y(i.value),m(l)}catch(l){console.error("获取部门风险数据失败:",l)}finally{t.value=!1}},m=l=>{const s={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,bottom:10,data:l.map(r=>r.title)},series:[{name:"部门风险数量",type:"pie",radius:"70%",avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:l.map(r=>({value:r.value,name:r.title}))}]};o.setOption(s)};return x(async()=>{await I(),_()}),L(()=>{o&&(o.dispose(),o=null),window.removeEventListener("resize",n)}),(l,s)=>{const r=O;return c(),u("div",P,[t.value?(c(),u("div",j,[S(r,{size:"24px"},{default:D(()=>[...s[0]||(s[0]=[$("图表加载中...",-1)])]),_:1})])):k("",!0),h("div",{ref_key:"pieChartRef",ref:i,class:"chart-container"},null,512)])}}},M=g(J,[["__scopeId","data-v-d5b601f6"]]),U={class:"stats-card"},q={key:0,class:"loading-container"},F={__name:"AreaStats",setup(w){a("");const t=a(!0),i=a(null),o=a(null);let e=null;const n=a({season:[],set_etp_id:"",level:""}),_=()=>{e==null||e.resize()},m=async()=>{try{t.value=!0;const s=await V(n.value);e=y(i.value),l(s)}catch(s){console.error("获取区域风险数据失败:",s)}finally{t.value=!1}},l=s=>{const r={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,bottom:10,data:s.map(d=>d.title)},series:[{name:"区域风险数量",type:"pie",radius:"70%",avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:s.map(d=>({value:d.value,name:d.title}))}]};e.setOption(r)};return x(()=>{m()}),L(()=>{e&&(e.dispose(),e=null),window.removeEventListener("resize",_)}),(s,r)=>{const d=O;return c(),u("div",U,[t.value?(c(),u("div",q,[S(d,{size:"24px"},{default:D(()=>[...r[0]||(r[0]=[$("图表加载中...",-1)])]),_:1})])):k("",!0),h("div",{ref_key:"pieChartRef",ref:i,class:"chart-container"},null,512),h("div",{ref_key:"barChartRef",ref:o,class:"chart-container"},null,512)])}}},G=g(F,[["__scopeId","data-v-ad847d4c"]]),H={class:"stats-card"},K={key:0,class:"loading-container"},Q={__name:"RiskLevelStats",setup(w){a("");const t=a(!0),i=a(null),o=a(null);let e=null,n=null;const _=[{id:1,name:"重大风险"},{id:2,name:"较大风险"},{id:3,name:"一般风险"},{id:4,name:"低风险"}],m=a({season:[],set_etp_id:""}),l=()=>{e&&e.dispose(),n&&n.dispose(),e=y(i.value),n=y(o.value),window.addEventListener("resize",s)},s=()=>{e==null||e.resize(),n==null||n.resize()},r=async()=>{try{t.value=!0;const f=await A(m.value);d(f)}catch(f){console.error("获取风险分级数据失败:",f)}finally{t.value=!1}},d=f=>{const b={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,bottom:10,data:f.map(p=>{const v=_.find(R=>R.id==p.title);return v?v.name:p.title})},series:[{name:"风险分级",type:"pie",radius:"70%",avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:f.map(p=>{const v=_.find(R=>R.id==p.title);return{value:p.value,name:v?v.name:p.title}})}]};e.setOption(b)};return x(()=>{l(),r()}),L(()=>{e&&(e.dispose(),e=null),n&&(n.dispose(),n=null),window.removeEventListener("resize",s)}),(f,b)=>{const p=O;return c(),u("div",H,[t.value?(c(),u("div",K,[S(p,{size:"24px"},{default:D(()=>[...b[0]||(b[0]=[$("图表加载中...",-1)])]),_:1})])):k("",!0),h("div",{ref_key:"pieChartRef",ref:i,class:"chart-container"},null,512),h("div",{ref_key:"barChartRef",ref:o,class:"chart-container"},null,512)])}}},X=g(Q,[["__scopeId","data-v-4b219c8b"]]),Y={class:"flex-center h-[100vh] w-100% items-center relative"},B=N({__name:"index",setup(w){const t=a("department-stats");return E("riskStats-click-tab",i=>{t.value=i.name}),(i,o)=>(c(),u("div",Y,[C(t)==="department-stats"?(c(),z(M,{key:0})):C(t)==="area-stats"?(c(),z(G,{key:1})):C(t)==="level-stats"?(c(),z(X,{key:2})):k("",!0)]))}});typeof W=="function"&&W(B);const de=g(B,[["__scopeId","data-v-1781ba7c"]]);export{de as default};
