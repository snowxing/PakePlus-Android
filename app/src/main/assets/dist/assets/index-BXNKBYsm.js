import{u as O,E as b}from"./useSystemTheme-lyMPqukv.js";import{d as C,r as v,w as z,o as D,g as $,a as h,i as g,h as i,b as u,p as S,v as N,l as V,y as P,F as R,E as H,c as F,by as q,m as x,a2 as L,aU as T,H as W,J as j,aq as G,U as I,B as J,e as Y}from"./index-5kp1FiRg.js";import{g as X,c as k,e as K}from"./accident-mBQzO3bB.js";import{c as w}from"./cloneDeep-DZmAQtLi.js";import{u as Q,i as Z,a as ee,b as te,c as oe,d as ne}from"./install-CoVyZzHx.js";import{i as ae}from"./install-DOWDe9Pp.js";import{h as se}from"./install-QPGF1BwB.js";import{i as le}from"./install-8Xh6dgN5.js";import"./createSeriesDataSimply-BFEE_GIw.js";const re=C({__name:"ReportChart",props:{form:{}},setup(m){const s=m;O(),Q([Z,ae,ee,te,oe,ne,se,le]);const c={tooltip:{trigger:"item"},legend:{orient:"horizontal",left:"center",bottom:0},grid:{top:20},series:[{name:"",type:"pie",radius:"50%",center:["50%","40%"],data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},l=v(w(c)),a=v(w(c)),d=v(w(c)),r=v({tooltip:{trigger:"axis"},legend:{data:["Email","Union Ads","Video Ads","Direct","Search Engine"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]});function p(t){const o=S(t.date).format("YYYY"),f=S(t.date).format("MM");X({level:t.level,Y:o,M:f}).then(n=>{l.value.series[0].data=n.map(e=>({name:e.title,value:e.value}))}),k({level:t.level,Y:o,M:f,type:3}).then(n=>{a.value.series[0].data=n.map(e=>({name:e.title,value:e.value}))}),k({level:t.level,Y:o,M:f,type:0}).then(n=>{d.value.series[0].data=n.map(e=>({name:e.title,value:e.value}))}),K({level:t.level,Y:o,M:f,type:0}).then(n=>{var e;r.value.xAxis.data=n.data.map(_=>_.name),r.value.series=(e=n.data)==null?void 0:e.map(_=>({..._,type:"line"}))})}return z(()=>s.form,t=>{p(t)},{deep:!0}),D(()=>{p(s.form)}),(t,o)=>(h(),$("div",null,[o[0]||(o[0]=g("div",{class:"title"}," 部门事故事件数量统计 ",-1)),i(u(b),{class:"chart",option:l.value,autoresize:""},null,8,["option"]),o[1]||(o[1]=g("div",{class:"title"}," 事故事件等级数量统计 ",-1)),i(u(b),{class:"chart",option:a.value,autoresize:""},null,8,["option"]),o[2]||(o[2]=g("div",{class:"title"}," 事故分类统计 ",-1)),i(u(b),{class:"chart",option:d.value,autoresize:""},null,8,["option"]),o[3]||(o[3]=g("div",{class:"title"}," 事故统计趋势图 ",-1)),i(u(b),{class:"chart",option:r.value,autoresize:""},null,8,["option"])]))}}),ie=N(re,[["__scopeId","data-v-35016490"]]),ue={style:{padding:"10px",display:"flex"}},me=C({__name:"ProSearchForm",props:{floating:{},form:{}},emits:["update:form","onClose"],setup(m,{emit:s}){const c=m,l=s,a=document.querySelector("section").offsetWidth-80,d=window.innerHeight-150;V({...c.form});const r=v(null),p=v(!1);function t(n,e,_){n.stopPropagation(),p.value=!0}function o(){l("onClose",{})}function f(){p.value=!1}return(n,e)=>{const _=q,B=W,M=L,U=G;return h(),$("div",null,[m.floating?(h(!0),$(R,{key:0},H(m.floating.slice().reverse(),(y,A)=>(h(),F(_,{key:y.key,offset:{x:a,y:d-A*80},teleport:r.value,icon:y.icon,onClick:E=>t(E)},null,8,["offset","teleport","icon","onClick"]))),128)):P("",!0),i(U,{show:p.value,"onUpdate:show":e[0]||(e[0]=y=>p.value=y),position:"bottom",onClose:o},{default:x(()=>[i(M,{onSubmit:f},{default:x(()=>[T(n.$slots,"searchForm",{form:m.form}),g("div",ue,[i(B,{round:"",block:"",type:"primary","native-type":"submit"},{default:x(()=>[...e[1]||(e[1]=[j(" 查询 ",-1)])]),_:1})])]),_:3})]),_:3},8,["show"])])}}}),pe=C({__name:"ReportSearch",props:{form:{}},emits:["update:form"],setup(m,{emit:s}){const c=m,l=s,a=V({...c.form}),d=v(Array.from({length:5}).fill(0).map((p,t)=>({text:"".concat(t),value:"".concat(t)})));function r(){l("update:form",a)}return(p,t)=>{const o=I,f=J,n=me;return h(),F(n,{form:u(a),floating:[{icon:"search",key:"search"}],onOnClose:r},{searchForm:x(()=>[i(o,{modelValue:u(a).level,"onUpdate:modelValue":t[0]||(t[0]=e=>u(a).level=e),label:"事故等级",columns:u(d),placeholder:"请选择事故等级"},null,8,["modelValue","columns"]),i(f,{modelValue:u(a).date,"onUpdate:modelValue":t[1]||(t[1]=e=>u(a).date=e),format:"YYYY-MM",label:"发生时间",placeholder:"请选择"},null,8,["modelValue"])]),_:1},8,["form"])}}}),ce={class:"flex-center w-100% items-center"},de=C({__name:"index",setup(m){const s=v({level:"0",date:S(new Date).format("YYYY-MM")});return(c,l)=>{const a=pe,d=ie;return h(),$("div",ce,[i(a,{form:s.value,"onUpdate:form":l[0]||(l[0]=r=>s.value=r)},null,8,["form"]),i(d,{form:s.value,"onUpdate:form":l[1]||(l[1]=r=>s.value=r)},null,8,["form"])])}}});typeof Y=="function"&&Y(de);export{de as default};
