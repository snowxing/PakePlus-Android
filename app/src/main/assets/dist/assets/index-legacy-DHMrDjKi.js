System.register(["./useTabsListener-legacy-BqsF0NKt.js","./index-legacy-CK9unWWd.js","./config-legacy-CMljs_xA.js","./HazardListSearchForm.vue_vue_type_script_setup_true_lang-legacy-Cqh8BITg.js","./index-legacy-Bv-nUzTo.js","./install-legacy-BpR_-QHD.js","./install-legacy-DLtSJaar.js","./install-legacy-NwM8Ok8V.js","./install-legacy-CxeYzW-1.js","./createSeriesDataSimply-legacy-BROSo_wZ.js","./install-legacy-B99kKqGh.js","./install-legacy-CjFeFKKo.js"],function(e,t){"use strict";var a,l,s,i,n,r,o,c,d,u,b,m,p,f,h,v,_,g,y,x,w,z,k,S,C,L,H,W,N,j,D,E,O,R,T,P,U;return{setters:[e=>{a=e.u},e=>{l=e.aB,s=e.d,i=e.j,n=e.l,r=e.r,o=e.w,c=e.o,d=e.g,u=e.a,b=e.h,m=e.B,p=e.G,f=e.F,h=e.k,v=e.c,_=e.m,g=e.au,y=e.b,x=e.i,w=e.ad,z=e._,k=e.H,S=e.J,C=e.aC,L=e.D,H=e.C,W=e.s,N=e.aj,j=e.t,D=e.v,E=e.aD,O=e.aE,R=e.e},e=>{T=e.c},e=>{P=e._},null,e=>{U=e.e},null,null,null,null,null,null],execute:function(){const t=s({__name:"DeferredSearchForm",props:{form:{default:{}}},emits:["update:form"],setup(e,{emit:t}){const a=e,l=t;i();const s=n({...a.form});return r([]),r([]),r({label:"title",value:"node_id",children:"child"}),o(()=>s,e=>{l("update:form",e)},{deep:!0}),o(()=>a.form,e=>{Object.assign(s,e)},{deep:!0,immediate:!0}),c(()=>{}),(e,t)=>{const a=m,l=p;return u(),d(f,null,[b(a,{"model-value":s.year,format:"YYYY",placeholder:"请选择年度","onUpdate:modelValue":t[0]||(t[0]=e=>e&&(s.year=e))},null,8,["model-value"]),b(l,{modelValue:s.change_hazard,"onUpdate:modelValue":t[1]||(t[1]=e=>s.change_hazard=e),type:"text",name:"text",label:"",placeholder:"请输入变更隐患"},null,8,["modelValue"])],64)}}}),F={class:"text-12px"},Y=s({__name:"DeferredLedger",setup(e){const a=i(),{routerPush:s}=h(),n=[{icon:"search",key:"search"}],o=[{title:"延期时间",className:"three",key:"date_1",uname:"",width:100,type:"selection"},{title:"变更原因",className:"three",key:"input_3",uname:"",type:"selection"},{title:"变更隐患",className:"three",key:"desc",width:"20%",uname:"",type:"selection"}],c=[{status:0,name:"退回"},{status:1,name:"确认"},{status:2,name:"待审核"}],d=r({page:1,page_size:30,year:"",change_hazard:""});async function m({pageNum:e}){const t={page:e||1,...d.value},a=await async function(e){return l.get("/enbase/risk_delay_list",{params:e})}(t);return{total:Number(a?.count||0)||0,data:a?.data||[]}}function p(e){const{eid:t}=a.userInfo,l=new RegExp(t,"g"),i=[{label:"原纳期时间",value:e.date_2},{label:"延期时间",value:e.date_1},{label:"申请人",value:e.uid_user_name},{label:"申请人工号",value:e.uid_account.replace(l,"")},{label:"批准人",value:e.check_uid_user_name},{label:"批准人工号",value:e.check_uid_account.replace(l,"")},{label:"备注",value:e.input_1}];s("doublePreventionDetail",{detail:JSON.stringify(i)})}return(e,a)=>{const l=z;return u(),v(l,{form:y(d),"onUpdate:form":a[1]||(a[1]=e=>g(d)?d.value=e:null),columns:o,request:m,floating:n,onOnRowClick:p},{"cell-radio_6":_(({row:e})=>[x("div",F,w(c.find(t=>t.status===e.radio_6)?.name||""),1)]),searchForm:_(()=>[b(t,{form:y(d),"onUpdate:form":a[0]||(a[0]=e=>g(d)?d.value=e:null)},null,8,["form"])]),_:1},8,["form"])}}}),A={class:"text-12px"},I={class:"text-12px"},J={class:"flex items-center"},V=s({__name:"HazardList",setup(e){const{routerPush:t}=h(),a=[{title:"检查时间",className:"three",key:"find_time",uname:"",width:"28%",type:"selection"},{title:"隐患描述",className:"three",key:"desc",uname:"",width:"30%",editable:!1,searchable:!1},{title:"隐患级别",key:"level",width:"25%"},{title:"状态",key:"status",width:"20%"},{title:"来源",className:"three",key:"sources",uname:"",width:100,editable:!1,searchable:!1}],s=[{value:10,label:"5S"},{value:11,label:"脚手搭设"},{value:12,label:"个人防护"},{value:13,label:"动能皮带"},{value:14,label:"脚手点检"},{value:15,label:"脚手定置"},{value:16,label:"定置管理"},{value:17,label:"安全用电"},{value:18,label:"管线架空"},{value:19,label:"设备设施"},{value:20,label:"作业安全"},{value:21,label:"设备点检"},{value:22,label:"安全监护"},{value:23,label:"私搭私拆"},{value:24,label:"目视管理"},{value:25,label:"作业审批"},{value:26,label:"通风照明"},{value:27,label:"脚手材料"},{value:28,label:"消防管理"},{value:29,label:"违章吸烟"},{value:30,label:"火灾"},{value:31,label:"皮带出舱"},{value:32,label:"攀爬脚手"},{value:33,label:"环保"},{value:34,label:"高空抛物"},{value:35,label:"其他"},{value:36,label:"设备保护"},{value:37,label:"跑冒滴漏"}],i=[{icon:"search",key:"search"}],n=r({page:1,inspect_name:"",sort:"zh",inspect_type:0,status:-1,level:"",set_etp_id:"",start_date:"",end_date:""});async function o({pageNum:e}={pageNum:1}){const t={...n.value,page:e},a=await async function(e){return l.get("/ensafe/risk_record_list",{params:e})}(t);return{total:Number(a.count)||0,data:a.data||[]}}function c(e){let a=T.trans("zhenggai_status",e.status);0==e.status&&"1"==e.sign&&(a="超纳期");const l=[{label:"位置",value:e.place},{label:"隐患级别",value:T.trans("hidden_level_list",e.level)},{label:"隐患描述",value:e.desc},{label:"整改要求及措施",value:e.fix_policy},{label:"责任部门",value:e.fixman_uid_department_id_depart_name},{label:"状态",value:a},{label:"隐患类别",value:s.find(t=>t.value===e.risk_value)?.label||""},{label:"责任人",value:e.fixman_uid_user_name},{label:"整改纳期",value:e.need_fix_time},{label:"资金投入",value:e.money},{label:"整改验收人",value:e.fixman},{label:"发现地点",value:e.place},{label:"发现时间",value:e.find_time},{label:"整改前图片",value:e.before_image,renderType:"image"},{label:"整改后图片",value:e.after_image,renderType:"image"}];t("doublePreventionDetail",{detail:JSON.stringify(l)})}return(e,l)=>{const s=k,r=z;return u(),v(r,{columns:a,request:o,form:y(n),"onUpdate:form":l[1]||(l[1]=e=>g(n)?n.value=e:null),floating:i,onOnRowClick:c},{"cell-level":_(({row:e})=>[x("div",A,w(y(T).trans("hidden_level_list",e.level)),1)]),"cell-status":_(({row:e})=>[x("div",I,w("0"===e.status&&"1"===e.sign?"超纳期":y(T).trans("zhenggai_status",e.status)),1)]),"cell-sources":_(({row:e})=>[x("div",J,[b(s,{disabled:!e.process_inst_id||"0"===e.process_inst_id,type:"primary",size:"mini",onClick:a=>{t("task-process",{task_id:0,tid:e.process_inst_id,viewtask:!0})}},{default:_(()=>[...l[2]||(l[2]=[S(" 来源 ",-1)])]),_:1},8,["disabled","onClick"])])]),searchForm:_(()=>[b(P,{form:y(n),"onUpdate:form":l[0]||(l[0]=e=>g(n)?n.value=e:null)},null,8,["form"])]),_:1},8,["form"])}}}),B=s({__name:"bepartmentHiddenDanger",setup(e){const t=r(null);let a=null;async function s(){W({message:"加载中...",forbidClick:!0});const e={set_etp_id:"@",level:"0",accident_type:"0",department_id:"0",season:""};try{const s=await async function(e){return l.get("/statistics/risk_source_department",{params:e})}(e);s.forEach(e=>{e.name=e.title}),await N(),a&&a.dispose(),a=U(t.value);const i={title:{text:"部门隐患数量统计",show:!1},tooltip:{show:!0,trigger:"item",formatter:"{b} : {c} ({d}%)",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#333"}},legend:{left:0,bottom:0,itemWidth:10,itemHeight:10,textStyle:{fontSize:12}},series:[{type:"pie",radius:["40%","60%"],center:["50%","40%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"outside",formatter:" {c} ({d}%)",fontSize:12,color:"#333",alignTo:"edge",edgeDistance:10,rich:{b:{fontWeight:"bold",lineHeight:22}}},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold"}},labelLine:{show:!0},data:s}],color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc","#4cabce"]};a.setOption(i)}catch(s){console.error("加载部门隐患数量统计失败",s)}finally{j()}}function i(){a&&a.resize()}return c(()=>{s(),window.addEventListener("resize",i)}),C(()=>{a&&(a.dispose(),a=null),window.removeEventListener("resize",i)}),(e,a)=>{const l=H,s=L;return u(),d("div",null,[b(s,{class:"mb-2"},{default:_(()=>[b(l,{title:"部门隐患数量统计",class:"!p-0","title-class":"text-white text-center bg-[#032e6d] py-2 font-semibold text-[15px]",border:!1})]),_:1}),x("div",{id:"chartContainer",ref_key:"chartContainerRef",ref:t,class:"my-30px px-16px h-[250px] w-100%"},null,512)])}}}),q=s({__name:"RegionalHazards",setup(e){const t=r(null);let a=null;const s=async()=>{W({message:"加载中...",forbidClick:!0});const e={set_etp_id:"@",level:"0",accident_type:"0",department_id:"0",season:""};try{const s=await async function(e){return l.get("/statistics/risk_source_area",{params:e})}(e);s.forEach(e=>{e.name=e.title,e.value=Number(e.value)}),await N(),a&&a.dispose(),a=U(t.value);const i={title:{text:"区域隐患数量统计",show:!1},tooltip:{show:!0,trigger:"item",formatter:"{b} : {c} ({d}%)",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#333"}},legend:{left:0,bottom:-20,itemWidth:10,itemHeight:10,textStyle:{fontSize:12}},series:[{type:"pie",radius:["40%","60%"],center:["50%","40%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"outside",formatter:"{c} ({d}%)",fontSize:12,color:"#333",alignTo:"edge",edgeDistance:10,rich:{b:{fontWeight:"bold",lineHeight:22}}},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold"}},labelLine:{show:!0,length:10,length2:10,smooth:!0},data:s}],color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc","#4cabce"]};a.setOption(i)}catch(s){console.error("加载区域隐患数量统计失败",s)}finally{j()}},i=()=>{a&&a.resize()};return c(()=>{s(),window.addEventListener("resize",i)}),C(()=>{a&&(a.dispose(),a=null),window.removeEventListener("resize",i)}),(e,a)=>{const l=H,s=L;return u(),d("div",null,[b(s,{class:"mb-2"},{default:_(()=>[b(l,{title:"区域隐患数量统计",class:"!p-0","title-class":"text-white text-center bg-[#032e6d] py-2 font-semibold text-[15px]",border:!1})]),_:1}),x("div",{ref_key:"chartContainerRef",ref:t,id:"chartContainer",class:"w-100% h-[250px] px-16px mb-30px"},null,512)])}}}),G=s({__name:"HazardClassification",setup(e){const t=r(null);let a=null;async function s(){W({message:"加载中...",forbidClick:!0});const e={set_etp_id:"@",level:"0",season:""};try{const s=await async function(e){return l.get("/statistics/risk",{params:e})}(e),i=s.map(e=>({name:e.title,value:Number(e.value)}));await N(),a&&a.dispose(),a=U(t.value);const n={title:{text:"隐患分类统计",show:!1},tooltip:{show:!0,trigger:"item",formatter:"{b} : {c} ({d}%)",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#333"}},legend:{type:"scroll",orient:"horizontal",left:"center",bottom:0,itemWidth:10,itemHeight:10,textStyle:{fontSize:12},pageButtonPosition:"end",pageTextStyle:{color:"#333"},formatter:e=>e.length>12?`${e.substring(0,12)}...`:e},grid:{containLabel:!0},series:[{type:"pie",radius:["40%","55%"],center:["50%","40%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"outside",formatter:"{c} ({d}%)",fontSize:12,color:"#333",alignTo:"edge",edgeDistance:10,rich:{b:{fontWeight:"bold",lineHeight:22}}},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold"}},labelLine:{show:!0,length:10,length2:10,smooth:!0},data:i}],color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc","#4cabce"]};a.setOption(n)}catch(s){console.error("加载隐患分类统计失败",s)}finally{j()}}function i(){a&&a.resize()}return c(()=>{s(),window.addEventListener("resize",i)}),C(()=>{a&&(a.dispose(),a=null),window.removeEventListener("resize",i)}),(e,a)=>{const l=H,s=L;return u(),d("div",null,[b(s,{class:"mb-2"},{default:_(()=>[b(l,{title:"隐患分类统计",class:"!p-0","title-class":"text-white text-center bg-[#032e6d] py-2 font-semibold text-[15px]",border:!1})]),_:1}),x("div",{id:"chartContainer",ref_key:"chartContainerRef",ref:t,class:"mb-30px px-16px h-[350px] w-100%"},null,512)])}}}),Z={class:"text-12px mb-2 px-4 text-right"},K={class:"ml-4"},$=D(s({__name:"HazardStatisticalAnalysis",setup(e){const t=r(null);let a=null;const s=r(0),i=r(0);async function n(){W({message:"加载中...",forbidClick:!0});const e={set_etp_id:"@"};try{const n=await async function(e){return l.get("/ensafe/get_danger_count",{params:e})}(e);s.value=n.year_total||0,i.value=n.deal_total||0;const r=n.header||[],o=n.data||[];await N(),a&&a.dispose(),a=U(t.value);const c={title:{text:"隐患统计分析",show:!1},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{type:"scroll",orient:"horizontal",left:"center",bottom:0,itemWidth:10,itemHeight:10,textStyle:{fontSize:12}},grid:{left:"3%",right:"4%",bottom:"60px",top:"3%",containLabel:!0},xAxis:{type:"category",data:r,axisLabel:{interval:0,rotate:30,fontSize:12}},yAxis:{type:"value",splitLine:{lineStyle:{type:"dashed"}}},series:o.map(e=>({name:e.name,type:"line",data:e.data,smooth:!0,symbol:"circle",symbolSize:6,label:{show:!0,position:"top",fontSize:12},emphasis:{focus:"series"}})),color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc","#4cabce"],dataZoom:[{type:"slider",show:!0,xAxisIndex:[0],start:0,end:5}]};a.setOption(c)}catch(n){console.error("加载隐患统计分析失败",n)}finally{j()}}function o(){a&&a.resize()}return c(()=>{n(),window.addEventListener("resize",o)}),C(()=>{a&&(a.dispose(),a=null),window.removeEventListener("resize",o)}),(e,a)=>{const l=H,n=L;return u(),d("div",null,[b(n,{class:"mb-2"},{default:_(()=>[b(l,{title:"隐患统计分析",class:"!p-0","title-class":"text-white text-center bg-[#032e6d] py-2 font-semibold text-[15px]",border:!1})]),_:1}),x("div",Z,[S(" 本年累计数："+w(y(s))+" ",1),x("span",K,"整改累计数："+w(y(i)),1)]),x("div",{id:"chartContainer",ref_key:"chartContainerRef",ref:t,class:"mb-30px px-16px h-[350px] w-100%"},null,512)])}}}),[["__scopeId","data-v-e72db613"]]),M=s({__name:"HazardStats",setup:e=>(e,t)=>(u(),d(f,null,[b(B),b(q),b(G),b($)],64))}),Q={class:"flex-center h-[100vh] w-100% items-center"},X=e("default",s({__name:"index",setup(e){const t=r("basic");a("hazardList-tab",e=>{t.value=e.name});const l=E(()=>({HazardList:V,DeferredLedger:Y,HazardStats:M})),s=E(()=>l.value[t.value]||null);return(e,t)=>(u(),d("div",Q,[(u(),v(O(s.value)))]))}}));"function"==typeof R&&R(X)}}});
