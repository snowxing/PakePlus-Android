import{d as y,j as D,r as p,l as x,w as v,o as S,g as V,a as w,h as u,G as C,$ as F,F as U,k as N,c as O,m as k,au as b,b as f,i as R,ad as B,_ as z,bp as $,e as h}from"./index-5kp1FiRg.js";import{g as j}from"./healthRecord-nYYKLBYx.js";import{a as q}from"./index-BpTLWCN6.js";import{c as A}from"./config-BiPkORWZ.js";const E=y({__name:"HealthSearchForm",props:{form:{default:{}}},emits:["update:form"],setup(g,{emit:m}){const i=g,o=m,c=D();p([]);const r=p([]),_=p({label:"title",value:"node_id",children:"child"});async function a(){const{etp_id:n}=c.userInfo,t=await q({id:n,deep:2,enbase:1,is_node:1});r.value=[{title:"全部",node_id:"all",child:t||[]}]}const e=x({...i.form});return v(e,n=>{o("update:form",n)},{deep:!0}),v(()=>i.form,n=>{Object.assign(e,n)},{deep:!0,immediate:!0}),S(()=>{a()}),(n,t)=>{const l=C,d=F;return w(),V(U,null,[u(l,{modelValue:e.k,"onUpdate:modelValue":t[0]||(t[0]=s=>e.k=s),type:"text",name:"text",placeholder:"请输入工号"},null,8,["modelValue"]),u(l,{modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=s=>e.name=s),type:"text",name:"text",placeholder:"请输入姓名"},null,8,["modelValue"]),u(d,{value:e.department_id,"onUpdate:value":t[2]||(t[2]=s=>e.department_id=s),options:r.value,"field-names":_.value,placeholder:"请选择部门",onChange:t[3]||(t[3]=s=>e.department_id=s)},null,8,["value","options","field-names"])],64)}}}),J=y({__name:"healthRecord",setup(g){async function m({pageNum:a,form:e}){var l,d;const n=new FormData;n.append("page",a),n.append("page_size",e.page_size),n.append("cat_id",e.cat_id),n.append("search",JSON.stringify({k:e.k,department_id:((d=(l=e.department_id)==null?void 0:l[0])==null?void 0:d.value)||"",post_id:e.post_id,name:e.name}));const t=await j(n);return{total:Number(t.count),data:t.data}}const{routerPush:i}=N(),o=p({id:"",page_size:30,cat_id:6,type:"",name:"",k:"",department_id:"",post_id:""}),c=[{icon:"search",key:"search"}];function r(a){var n;const e=[{label:"工号",value:a.account},{label:"姓名",value:a.name},{label:"部门",value:a.department},{label:"岗位",value:a.position},{label:"年龄",value:a.age},{label:"入职时间",value:a.start_year},{label:"性别",value:a.gender==="1"?"男":"女"},{label:"身份证号",value:a.card_id},{label:"学历",value:(n=$.find(t=>{var l;return t.id.toString()===((l=a==null?void 0:a.edu)==null?void 0:l.toString())}))==null?void 0:n.name},{label:"体检附件",value:[a.photo],renderType:"image"}];i("siteDetail",{detail:JSON.stringify(e)})}const _=[{title:"姓名",key:"name",width:"25%"},{title:"工号",key:"account",width:"20%"},{title:"部门",key:"department",width:"20%"},{title:"岗位职务",key:"position",width:"25%"}];return(a,e)=>{const n=z;return w(),O(n,{form:f(o),"onUpdate:form":e[1]||(e[1]=t=>b(o)?o.value=t:null),columns:_,request:m,floating:c,onOnRowClick:r},{"cell-special":k(({row:t})=>[R("div",null,B(f(A).trans("equipment_type",t.special)),1)]),searchForm:k(()=>[u(E,{form:f(o),"onUpdate:form":e[0]||(e[0]=t=>b(o)?o.value=t:null)},null,8,["form"])]),_:1},8,["form"])}}});typeof h=="function"&&h(J);export{J as default};
