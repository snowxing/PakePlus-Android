System.register(["./index-legacy-CK9unWWd.js"],function(e,t){"use strict";var r,a,l,s,o,n,c;return{setters:[e=>{r=e.d,a=e.r,l=e.w,s=e.c,o=e.a,n=e.b,c=e.bg}],execute:function(){const t={input:"field",textarea:"field",select:"select",radio:"radio",checkbox:"checkbox",datePicker:"datetime-picker",timePicker:"datetime-picker",date:"v-datetime-picker",switch:"switch",slider:"slider",hidden:"hidden",cascader:"v-cascader",static:"v-group-button",treeselect:"v-treeselect",inputselect:"v-inputselect",label:"v-label"},i=["row","col","divider","card","tabs","tab-pane"],p=["col","style","class","control"];function d(e){const t={};for(const r in e){const a=e[r];if(null!=a)if("object"!=typeof a||Array.isArray(a))t[r]=a;else{const e=d(a);Object.keys(e).length&&(t[r]=e)}}return t}function u(e,t){return"staff"===e?.source&&"treeselect"===t.type?(e.dataType="treeselect","v-inputselect"):null}function y(e){const r=t[e.type]||e.type,a=function(e,t={},r={}){const a={...t};switch(e){case"label":return{...r,props:a};case"input":return a.readonly&&r.validate&&!r.value&&(r.validate=r.validate?.map(e=>e.required?{...e,required:!1}:e)),{...r,placeholder:a.placeholder||r.placeholder||"请输入",readonly:a.readonly??!1,disabled:a.disabled??!1};case"textarea":{const t="textarea"===e,r={placeholder:a.placeholder,clearable:a.clearable??!0};return t&&(r.type="textarea",r.rows=a.rows??3),d({...a,...r})}case"select":{const e=r.options?.map(e=>({...e,text:e.label??e.text,value:String(e.value)}))||[];return r.value&&(r.value=String(r.value)),d({...a,columns:e,options:e,columnsFieldNames:{text:"label",value:"value"},disabled:a.disabled??a.readonly,props:{...a}})}case"switch":return d({activeValue:a.activeValue??!0,inactiveValue:a.inactiveValue??!1,...a});case"date":case"datePicker":case"timePicker":return d({...a,type:a.type??"datetime",format:a.format??"yyyy-MM-dd HH:mm:ss",placeholder:a.placeholder??"请选择时间"});case"upload":{const e=JSON.parse(JSON.stringify(a)),{max:t,maxSize:l,disabled:s,readonly:o,...n}=e,c=r.props||{},i=".jpg,.jpeg,.png,.doc,.docx,.pdf,.xls,.xlsx,.zip,.rar,.7z,.ppt,.pptx,.txt",p=r.title?.includes("附件");let d=c.accept;d||(d=p?c?.format||i:"image/*");let u=c.action;return u||(u=p?"/api/uploader/doc":"/api/uploader/image"),{...n,disabled:s||o,action:u,accept:d,onSuccess:"$FNX:const res = $inject.args[0];\nconst file = $inject.args[1];\n\nfile.url = res.data.url;"}}case"cascader":return{...r,options:a.data||[],multiple:!0,...a,disabled:a.disabled??a.readonly};default:return d(a)}}(e.type,e.props,e),l={...e,type:u(a,e)||r,props:a};for(const t of p)t in l&&delete l[t];return"select"===e.type&&(delete l.options,!1===e?.props?.multiple&&(l.value=Array.isArray(e.value)?e.value[0]:e.value)),"treeselect"===e.type&&Array.isArray(e.options)&&(l.props={...l.props||{},options:e.options.map(e=>({...e}))}),d(l)}function f(e,t){const r=[];for(const a of e)if(!i.includes(a.type))if("dynamic"===a.type&&Array.isArray(a.row)){const e=[],l=f(a.row[0]);e.push(...l);const s={},o={};for(const t of a.row)for(const e of t)if("treeselect"===e.type&&Array.isArray(e.options)){const t=e.field||e.props?.field;if(!t)continue;const r=e.options.map(e=>({label:e.label??e.text,text:e.label??e.text,value:String(e.value)}));s[t]=[...s[t]||[],...r],e.ref&&(o[e.ref]=[...o[e.ref]||[],...r])}if(Object.keys(s).length)for(const t of e){const e=t.field||t.props?.field;if(!e)continue;const r=s[e];if("v-treeselect"===t.type&&Array.isArray(r)){const e=new Set,a=[];for(const t of r){const r=String(t.value);e.has(r)||(e.add(r),a.push({...t,value:r}))}t.props={...t.props||{},options:a,instanceOptionsMap:o}}}const n=[];for(const t of a.row){const e=f(t),r={};e.forEach(e=>{r[e.field]=e.value}),n.push(r)}r.push({...a,props:{min:1,max:10,rule:e,disabled:t},value:a.value||n||[{}],type:"group"})}else r.push(y(a));return r}e("_",r({__name:"v-form-create",props:{json:{type:[Object,Array],default:()=>[]},ruleKey:{type:String,default:"inputs"},convert:{type:Function,default:()=>null},renderContainer:{type:Function,default:()=>null},expand:{type:Boolean,default:!0}},setup(e){const t=e,r=a([]);l(()=>t.json,e=>{let a=e[t.ruleKey],l=!1;Array.isArray(e)?a=e:l=e.readonly;const s=f(a,l),o=t.convert(e);let n=o?[...o,...s]:s;Array.isArray(e)||(n=[{type:"v-collapse",children:n,vm:["v-collapse"],props:{title:t.renderContainer(e)||e.title,expand:t.expand}}]),r.value=n},{immediate:!0});const i={submitBtn:{show:!1},resetBtn:{show:!1}};return(e,t)=>(o(),s(n(c),{rule:n(r),option:i},null,8,["rule"]))}}))}}});
