System.register(["./information-legacy-CTA3FmK7.js","./index-legacy-CK9unWWd.js","./SearchForm.vue_vue_type_script_setup_true_lang-legacy-CXKhuiiB.js","./useTabsListener-legacy-BqsF0NKt.js"],function(e,l){"use strict";var a,u,o,n,d,t,r,m,s,i,c,v,p,_,b,V,h,f,g,y,j,U,k,w,x,q,S,Y,C,D,I,O,z,M,L,N,A,J;return{setters:[e=>{a=e.g,u=e.a,o=e.b,n=e.c,d=e.d,t=e.e},e=>{r=e.d,m=e.j,s=e.r,i=e.o,c=e.O,v=e.a0,p=e.x,_=e.g,b=e.a,V=e.h,h=e.v,f=e.k,g=e.c,y=e._,j=e.m,U=e.i,k=e.C,w=e.D,x=e.G,q=e.$,S=e.a1,Y=e.B,C=e.H,D=e.J,I=e.a2,O=e.L,z=e.M,M=e.y,L=e.b,N=e.e},e=>{A=e._},e=>{J=e.u}],execute:function(){const l={class:"tree-container"},F={key:0,class:"empty-state"},P={key:1,style:{height:"calc(100vh - 60px)"}},T=h(r({__name:"OrgStructure",setup(e){const u=m(),o=s(null),n=s(!1);i(()=>{!async function(){try{const{pid:e,etp_id:l}=u.userInfo;n.value=!0;const d=await a({id:"SELF0",deep:3,base:1,is_node:"0"!==e?1:0});n.value=!1,console.log("API响应数据:",d),d&&d.length?(o.value={id:d[0]?.parent_id,title:d[0]?.etp_id_name,child:d.map(e=>({...e,_expanded:!1}))},console.log(o.value)):o.value=null}catch(e){console.error("获取数据失败:",e),o.value=null}}()});const d={id:"id",pid:"parent_id",label:"title",children:"child"};return(e,a)=>{const u=c("vue3-tree-org"),t=v("loading");return p((b(),_("div",l,[o.value?(b(),_("div",P,[V(u,{disabled:!0,draggable:"",center:"","node-draggable":!1,data:o.value,props:d,collapsable:!0,horizontal:!1,scalable:!0,"expand-all":"true","default-expand-level":3},null,8,["data"])])):(b(),_("div",F," 暂无数据 "))])),[[t,n.value]])}}}),[["__scopeId","data-v-d6be4f5f"]]),$=r({__name:"QualiCertAndLicenses",setup(e){const{routerPush:l}=f(),a=s({name:"",authority:"",set_etp_id:""}),o=[{icon:"search",key:"search"}];async function n({pageNum:e}){const l=await u({page:e,page_size:30,...a.value});return{total:Number(l.count),data:l.data}}const d=[{title:"名称",key:"name",width:"35%"},{title:"颁发机构",key:"authority",width:"30%"},{title:"到期日",key:"expire_date",width:"25%"}],t=e=>{const a=[{value:e.name,label:"名称"},{value:e.authority,label:"颁发机构"},{value:e.issue_date,label:"颁发日期"},{value:e.certificate_level,label:"证书等级"},{value:e.certificate_object,label:"持证对象"},{value:e.object_type,label:"对象类型"},{value:e.expire_date,label:"到期日"},{value:e.department,label:"责任部门"},{value:e.principal,label:"责任人"},{value:e.note,label:"备注"},{value:e.files,label:"证书",renderType:"image"}];l("basicDetail",{detail:JSON.stringify(a)})};return(e,l)=>{const u=y;return b(),g(u,{columns:d,request:n,form:a.value,"onUpdate:form":l[1]||(l[1]=e=>a.value=e),floating:o,onOnRowClick:t},{searchForm:j(()=>[V(A,{form:a.value,"onUpdate:form":l[0]||(l[0]=e=>a.value=e)},null,8,["form"])]),_:1},8,["form"])}}}),Q={class:"form-container"},R={class:"form-content"},B={class:"modern-floating-btn"},E=h(r({__name:"Information",setup(e){const l=m(),a=s(),u=s({name:"",credit_code:"",sort_obj:{name:"",id:""},nature_obj:{name:"",id:""},scale_obj:{name:"",id:""},competent_unit:"",group:"",legal_person:"",post:"",founded:"",covered_area:"",staff_number:"",contact:"",tel:"",postal:"",city_obj:{name:""},address:"",map:{x:"",y:""},main_business:"",note:"",process:"",rank_obj:{name:"",id:""},safety_manager:"",phone:"",awh_name:"",awh_found_date:"",annual_value:"",department_name:"",found_date:"",manage_num:"",engineers_num:"",safe_obj:{name:"",id:""}}),r=s(!1),c=s(!1);s(!1),s(!1),s(!1);const v=s(!1),p=s(!1),h=s(!1),f=s([{name:"国企",value:"1"},{name:"外企",value:"2"},{name:"私企",value:"3"},{name:"合资",value:"4"}]),g=s([{name:"小型",value:"1"},{name:"中型",value:"2"},{name:"大型",value:"3"},{name:"微型",value:"4"}]),y=s([{name:"集团",value:"t0"},{name:"一级子公司",value:"t1"},{name:"二级子公司",value:"t2"}]),M=s([{name:"危险化工工艺",value:"1"},{name:"涉尘涉爆",value:"2"},{name:"重大危险源",value:"3"},{name:"有限(受限空间)",value:"4"}]),L=e=>{u.value.nature_obj={name:e.name,id:e.value},r.value=!1},N=e=>{u.value.scale_obj={name:e.name,id:e.value},c.value=!1},A=e=>{u.value.rank_obj={name:e.name,id:e.value},v.value=!1},J=e=>{u.value.safe_obj={name:e.name,id:e.value},p.value=!1},F=async()=>{try{await a.value.validate(),t(u.value).then(()=>{O("保存成功")}).catch(e=>{z(e.message||"保存失败")})}catch(e){z(e[0].message||"表单验证失败"),console.log("表单验证失败",e)}};return i(()=>{!async function(){try{const{etp_id:e}=l.userInfo,a=await o({id:e});console.log("API返回数据:",a),a&&a.name&&(u.value={...u.value,...a,sort_obj:a.sort_obj||{name:"",id:""},nature_obj:a.nature_obj||{name:"",id:""},scale_obj:a.scale_obj||{name:"",id:""},city_obj:a.city_obj||{name:""},rank_obj:a.rank_obj||{name:"",id:""},safe_obj:a.safe_obj||{name:"",id:""},map:{x:a.map_corrdinate?JSON.parse(a.map_corrdinate).x:"",y:a.map_corrdinate?JSON.parse(a.map_corrdinate).y:""}})}catch(e){console.error("获取企业数据失败:",e)}}(),n({is_node:0,id:22,deep:1,enbase:1}).then(e=>{e&&e.length&&(f.value=e.map(e=>({name:e.title,value:e.node_id})))}),d({c:0}).then(e=>{e&&e.length&&(u.value.city_obj={name:e[0].name})})}),(e,l)=>{const o=k,n=w,d=x,t=q,m=S,s=Y,i=C,O=I;return b(),_("div",Q,[V(n,null,{default:j(()=>[V(o,{title:"基本信息",class:"h5-title"})]),_:1}),U("div",R,[V(O,{"show-error-message":!1,ref_key:"formRef",ref:a},{default:j(()=>[V(d,{modelValue:u.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>u.value.name=e),label:"企业名称",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入企业名称"}]},null,8,["modelValue"]),V(d,{modelValue:u.value.credit_code,"onUpdate:modelValue":l[1]||(l[1]=e=>u.value.credit_code=e),label:"信用代码",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入信用代码"}]},null,8,["modelValue"]),V(t,{"model-value":u.value.sort_obj.id,options:f.value,"field-names":{label:"name",value:"value"},label:"所属行业",placeholder:"请选择所属行业","onUpdate:modelValue":l[2]||(l[2]=e=>u.value.sort_obj={id:e,name:f.value.find(l=>l.value===e)?.name||""})},null,8,["model-value","options"]),V(d,{modelValue:u.value.address,"onUpdate:modelValue":l[3]||(l[3]=e=>u.value.address=e),label:"企业地址",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.nature_obj.name,"onUpdate:modelValue":l[4]||(l[4]=e=>u.value.nature_obj.name=e),label:"企业性质",placeholder:"请选择","is-link":"",readonly:"",onClick:l[5]||(l[5]=e=>r.value=!0)},null,8,["modelValue"]),V(m,{show:r.value,"onUpdate:show":l[6]||(l[6]=e=>r.value=e),actions:f.value,onSelect:L},null,8,["show","actions"]),V(d,{modelValue:u.value.scale_obj.name,"onUpdate:modelValue":l[7]||(l[7]=e=>u.value.scale_obj.name=e),label:"公司规模",placeholder:"请选择","is-link":"",readonly:"",onClick:l[8]||(l[8]=e=>c.value=!0)},null,8,["modelValue"]),V(m,{show:c.value,"onUpdate:show":l[9]||(l[9]=e=>c.value=e),actions:g.value,onSelect:N},null,8,["show","actions"]),V(d,{modelValue:u.value.competent_unit,"onUpdate:modelValue":l[10]||(l[10]=e=>u.value.competent_unit=e),label:"主管单位",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.group,"onUpdate:modelValue":l[11]||(l[11]=e=>u.value.group=e),label:"所属集团",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.legal_person,"onUpdate:modelValue":l[12]||(l[12]=e=>u.value.legal_person=e),label:"法定代表人",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.post,"onUpdate:modelValue":l[13]||(l[13]=e=>u.value.post=e),label:"总经理",placeholder:"请输入"},null,8,["modelValue"]),V(s,{"model-value":u.value.founded,format:"YYYY-MM-DD",label:"成立时间",placeholder:"请选择","onUpdate:modelValue":l[14]||(l[14]=e=>e&&(u.value.founded=e))},null,8,["model-value"]),V(d,{modelValue:u.value.annual_value,"onUpdate:modelValue":l[15]||(l[15]=e=>u.value.annual_value=e),label:"年产值",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.staff_number,"onUpdate:modelValue":l[16]||(l[16]=e=>u.value.staff_number=e),label:"员工人数",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入员工人数"}]},null,8,["modelValue"]),V(d,{modelValue:u.value.covered_area,"onUpdate:modelValue":l[17]||(l[17]=e=>u.value.covered_area=e),label:"占地面积",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.contact,"onUpdate:modelValue":l[18]||(l[18]=e=>u.value.contact=e),label:"联系人",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.tel,"onUpdate:modelValue":l[19]||(l[19]=e=>u.value.tel=e),label:"联系方式",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.postal,"onUpdate:modelValue":l[20]||(l[20]=e=>u.value.postal=e),label:"邮政编码",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入邮政编码"}]},null,8,["modelValue"]),V(d,{modelValue:u.value.city_obj.name,"onUpdate:modelValue":l[21]||(l[21]=e=>u.value.city_obj.name=e),label:"行政区",placeholder:"请选择","is-link":"",readonly:"",onClick:l[22]||(l[22]=e=>h.value=!0)},null,8,["modelValue"]),V(d,{modelValue:u.value.address,"onUpdate:modelValue":l[23]||(l[23]=e=>u.value.address=e),label:"详细地址",placeholder:"请输入",type:"textarea",autosize:""},null,8,["modelValue"]),V(d,{"model-value":u.value.map.x&&u.value.map.y?`${u.value.map.x},${u.value.map.y}`:"",label:"地理坐标",placeholder:"暂无坐标",disabled:""},null,8,["model-value"]),V(d,{modelValue:u.value.main_business,"onUpdate:modelValue":l[24]||(l[24]=e=>u.value.main_business=e),label:"主营业务",placeholder:"请输入",type:"textarea",autosize:""},null,8,["modelValue"]),V(d,{modelValue:u.value.note,"onUpdate:modelValue":l[25]||(l[25]=e=>u.value.note=e),label:"公司简介",placeholder:"请输入",type:"textarea",autosize:""},null,8,["modelValue"]),V(d,{modelValue:u.value.process,"onUpdate:modelValue":l[26]||(l[26]=e=>u.value.process=e),label:"生产工艺",placeholder:"请输入",type:"textarea",autosize:""},null,8,["modelValue"]),V(d,{modelValue:u.value.rank_obj.name,"onUpdate:modelValue":l[27]||(l[27]=e=>u.value.rank_obj.name=e),label:"公司级别",placeholder:"请选择","is-link":"",readonly:"",onClick:l[28]||(l[28]=e=>v.value=!0)},null,8,["modelValue"]),V(m,{show:v.value,"onUpdate:show":l[29]||(l[29]=e=>v.value=e),actions:y.value,onSelect:A},null,8,["show","actions"]),V(n,null,{default:j(()=>[V(o,{title:"安全信息",class:"h5-title"})]),_:1}),V(d,{modelValue:u.value.safety_manager,"onUpdate:modelValue":l[30]||(l[30]=e=>u.value.safety_manager=e),label:"安全负责人",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入安全负责人"}]},null,8,["modelValue"]),V(d,{modelValue:u.value.phone,"onUpdate:modelValue":l[31]||(l[31]=e=>u.value.phone=e),label:"联系方式",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入联系方式"}]},null,8,["modelValue"]),V(d,{modelValue:u.value.awh_name,"onUpdate:modelValue":l[32]||(l[32]=e=>u.value.awh_name=e),label:"安委会名称",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入安委会名称"}]},null,8,["modelValue"]),V(s,{"model-value":u.value.awh_found_date,format:"YYYY-MM-DD",label:"成立时间",placeholder:"请选择","onUpdate:modelValue":l[33]||(l[33]=e=>e&&(u.value.awh_found_date=e))},null,8,["model-value"]),V(d,{modelValue:u.value.department_name,"onUpdate:modelValue":l[34]||(l[34]=e=>u.value.department_name=e),label:"安全机构名称",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入安全机构名称"}]},null,8,["modelValue"]),V(s,{"model-value":u.value.found_date,format:"YYYY-MM-DD",label:"成立时间",placeholder:"请选择","onUpdate:modelValue":l[35]||(l[35]=e=>e&&(u.value.found_date=e))},null,8,["model-value"]),V(d,{modelValue:u.value.manage_num,"onUpdate:modelValue":l[36]||(l[36]=e=>u.value.manage_num=e),label:"安全管理人数",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.engineers_num,"onUpdate:modelValue":l[37]||(l[37]=e=>u.value.engineers_num=e),label:"注安人数",placeholder:"请输入"},null,8,["modelValue"]),V(d,{modelValue:u.value.safe_obj.name,"onUpdate:modelValue":l[38]||(l[38]=e=>u.value.safe_obj.name=e),label:"风险标签",placeholder:"请选择","is-link":"",readonly:"",onClick:l[39]||(l[39]=e=>p.value=!0)},null,8,["modelValue"]),V(m,{show:p.value,"onUpdate:show":l[40]||(l[40]=e=>p.value=e),actions:M.value,onSelect:J},null,8,["show","actions"]),U("div",B,[V(i,{type:"primary",round:"",size:"large",onClick:F,class:"modern-save-btn"},{default:j(()=>[...l[41]||(l[41]=[D(" 保存 ",-1)])]),_:1})])]),_:1},512)])])}}}),[["__scopeId","data-v-38942393"]]),G={class:"flex-center w-100% items-center"},H=e("default",r({__name:"index",setup(e){const l=s("OrgStructure");return J("information-click-tab",e=>{l.value=e.name}),(e,a)=>(b(),_("div",G,["OrgStructure"===L(l)?(b(),g(T,{key:0})):M("",!0),"QualiCertAndLicenses"===L(l)?(b(),g($,{key:1})):M("",!0),"Information"===L(l)?(b(),g(E,{key:2})):M("",!0)]))}}));"function"==typeof N&&N(H)}}});
