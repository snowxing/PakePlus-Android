import{d as g,aD as d,c as V,a as C,au as w,b as y,bu as D,aB as h,ag as m}from"./index-5kp1FiRg.js";const L=g({__name:"v-uploader",props:{multiple:{type:Boolean},maxCount:{},value:{},modelValue:{},accept:{}},emits:["update:value","update:modelValue"],setup(n,{emit:f}){const u=n,p=f,l=d({get(){return u.value||u.modelValue||[]},set(e){p("update:value",e),p("update:modelValue",e)}}),s=d(()=>l.value.map((e,a)=>typeof e=="object"&&e.url?{...e,status:e.status||"done"}:{url:e,status:"done",uid:"".concat(Date.now(),"_").concat(a)}));function v(e){console.log("file",e.file.type);const a=e.file.type.startsWith("image/");console.log("isImage",a);const o=new FormData;o.append("file",e.file),e.content,[...s.value],u.maxCount,h.post(a?"/uploader/image":"/uploader/doc",o).then(t=>{var r;m("上传成功");const c=((r=t.data)==null?void 0:r.url)||t.url||"";if(u.maxCount===1)l.value=[c];else{const i=[...l.value];u.maxCount===1?i[0]=c:i.push(c),l.value=i}}).catch(()=>{m("上传失败")})}function x(e,a){const o=a.index,t=[...l.value];t.splice(o,1),l.value=t}return(e,a)=>{const o=D;return C(),V(o,{modelValue:y(s),"onUpdate:modelValue":a[0]||(a[0]=t=>w(s)?s.value=t:null),multiple:n.multiple,"after-read":v,"max-count":n.maxCount,accept:n.accept||"*",onDelete:x},null,8,["modelValue","multiple","max-count","accept"])}}});export{L as _};
