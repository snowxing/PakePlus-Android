import{d as y,j as x,l as C,r as i,w as f,o as D,g as F,a as b,h as c,G as V,B,F as O,k as R,c as S,m as _,au as g,b as v,i as U,ad as N,_ as T}from"./index-5kp1FiRg.js";import{g as Y}from"./baoyangManagement-Bkj08ZRC.js";import{c as h}from"./config-BiPkORWZ.js";import{a as $}from"./index-BpTLWCN6.js";const j=y({__name:"recordSearchForm",props:{form:{default:{}}},emits:["update:form"],setup(p,{emit:u}){const r=p,n=u,m=x(),o=C({...r.form}),d=i([]),e=i([]);i({label:"title",value:"node_id",children:"child"});async function t(){const{etp_id:l}=m.userInfo,a=await $({id:l,deep:2,enbase:1,is_node:1});e.value=a||[]}return f(o,l=>{n("update:form",l)},{deep:!0}),f(()=>r.form,l=>{Object.assign(o,l)},{deep:!0,immediate:!0}),D(()=>{t(),d.value=h.get("accident_type").map(l=>({text:l.name,value:l.id}))}),(l,a)=>{const k=V,w=B;return b(),F(O,null,[c(k,{modelValue:o.name,"onUpdate:modelValue":a[0]||(a[0]=s=>o.name=s),type:"text",name:"text",label:"",placeholder:"请输入演练名称"},null,8,["modelValue"]),c(w,{"model-value":o.year,format:"YYYY",placeholder:"请选择年度","onUpdate:modelValue":a[1]||(a[1]=s=>s&&(o.year=s))},null,8,["model-value"])],64)}}}),E=y({__name:"drillRecord",setup(p){async function u({pageNum:e}){const t=await Y({page:e,...n.value});return{total:Number(t.count),data:t.data}}const{routerPush:r}=R(),n=i({page_size:30,set_etp_id:"",department_id:"",year:"",type:2,name:"",date:"",staff_id:"",status:"",check:1}),m=[{icon:"search",key:"search"}];function o(e){const t=[{label:"演练名称",value:e.drill_name},{label:"组织部门",value:e.department},{label:"负责人",value:e.staff},{label:"状态",value:h.trans("drill_status",e.status)},{label:"演练地点",value:e.area_name},{label:"计划时间",value:e.year+e.month},{label:"备注",value:e.remarks},{label:"演练记录",value:[e.files_summingup],renderType:"image"},{label:"演练总结",value:[e.files_allsummingup],renderType:"image"},{label:"演练评估",value:[e.files_pingsummingup],renderType:"image"},{label:"附件",value:[e.files],renderType:"image"}];r("emergencyDetail",{detail:JSON.stringify(t)})}const d=[{title:"演练名称",key:"drill_name",width:"25%"},{title:"地点",key:"area_name",width:"20%"},{title:"组织部门",key:"department",width:"20%"},{title:"计划时间",key:"month",width:"20%"}];return(e,t)=>{const l=T;return b(),S(l,{form:v(n),"onUpdate:form":t[1]||(t[1]=a=>g(n)?n.value=a:null),columns:d,request:u,floating:m,onOnRowClick:o},{"cell-month":_(({row:a})=>[U("div",null,N("".concat(a.year).concat(a.month)),1)]),searchForm:_(()=>[c(j,{form:v(n),"onUpdate:form":t[0]||(t[0]=a=>g(n)?n.value=a:null)},null,8,["form"])]),_:1},8,["form"])}}});export{E as _};
