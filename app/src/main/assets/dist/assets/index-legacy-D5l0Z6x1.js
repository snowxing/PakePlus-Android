System.register(["./index-legacy-CK9unWWd.js"],function(e,a){"use strict";var n,i,l,t,d,s,m,o,u,v,c,r,p,h,f,g,y,_;return{setters:[e=>{n=e.aB,i=e.v,l=e.j,t=e.r,d=e.o,s=e.g,m=e.a,o=e.i,u=e.h,v=e.m,c=e.H,r=e.J,p=e.F,h=e.E,f=e.ad,g=e.aq,y=e.a_,_=e.e}],execute:function(){const a={class:"riskmap-container"},w={class:"map-container"},x=["src"],$={class:"popup-header"},k={class:"popup-content"},C={class:"info-title"},b={class:"info-value"},E={__name:"index",setup(e){const i=l()?.userInfo,_=t(!1),E=t(""),I=t(0),j=t(0),z=t([]),U=t([0,0]),q=t([]);t([]);const B=t([]),F=t(""),H=t(!1),J=[{id:0,name:"隐患",level:[{id:0,name:"全部"},{id:1,name:"重大"},{id:2,name:"较大"},{id:3,name:"一般"},{id:4,name:"低"}]},{id:1,name:"风险源",level:[{id:0,name:"全部"},{id:1,name:"重大"},{id:2,name:"较大"},{id:3,name:"一般"},{id:4,name:"低"}]},{id:2,name:"应急物资",level:[{id:0,name:"全部"},{id:1,name:"重大"},{id:2,name:"较大"},{id:3,name:"一般"},{id:4,name:"低"}]},{id:3,name:"许可作业",level:[{id:0,name:"全部"},{id:1,name:"重大"},{id:2,name:"较大"},{id:3,name:"一般"},{id:4,name:"低"}]},{id:4,name:"特殊设备",level:[{id:0,name:"全部"},{id:1,name:"重大"},{id:2,name:"较大"},{id:3,name:"一般"},{id:4,name:"低"}]},{id:5,name:"监控报警",level:[{id:0,name:"全部"},{id:1,name:"重大"},{id:2,name:"较大"},{id:3,name:"一般"},{id:4,name:"低"}]}];d(()=>{F.value=`http://z.saveus.cn/web/iframe/riskmap?type=1&level=0&x=${i.map.x}&y=${i.map.y}&eid=${i.eid}&etp_id=${i.etp_id}`,P()});const P=()=>{const e=[],a=[];J.forEach(n=>{e.push({text:n.name,value:n.id}),0===a.length&&n.level.forEach(e=>{a.push({text:e.name,value:e.id})})}),q.value=[{values:e},{values:a}],U.value=[0,0];const n=`${J[0].name}-${J[0].level[0].name}`;E.value=n,S()},S=async()=>{const e=J[U.value[0]],a=e.id,i=e.level[U.value[1]].id;try{const e=await(l={type:a,level:i,category:0},n.get("/ensafe/map_risk_list",{params:l})),t=e?.map_config?.map_corrdinate||{};I.value=t.x,j.value=t.y,z.value=[V(0,i,I.value,j.value,!0)]}catch(t){console.error("加载地图数据失败:",t)}var l},V=(e,a,n,i,l=!0)=>({iconPath:"/static/common/images/mark3.png",id:e,latitude:i,longitude:n,width:50,height:50}),A=()=>{_.value=!1},D=(e,a)=>{const n=`${J[a[0]].text}-${J[a[0]].level[a[1]].text}`;E.value=n,U.value=a,H.value=!1,S()},G=(e,a,n)=>{if(0===n){const n=J[a[0]].level.map(e=>({text:e.name,value:e.id}));e.setColumnValues(1,n),e.setIndexes([a[0],0])}};return(e,n)=>{const i=c,l=g,t=y;return m(),s("div",a,[o("div",w,[o("iframe",{frameborder:"no",border:"0",marginwidth:"0",marginheight:"0",scrolling:"no",allowtransparency:"yes",src:F.value,class:"map-iframe"},null,8,x)]),u(l,{show:_.value,"onUpdate:show":n[0]||(n[0]=e=>_.value=e),position:"center",round:"",style:{width:"80%",padding:"20px"}},{default:v(()=>[o("div",$,[n[4]||(n[4]=o("h3",null,"详情",-1)),u(i,{size:"small",onClick:A},{default:v(()=>[...n[3]||(n[3]=[r("关闭",-1)])]),_:1})]),o("div",k,[(m(!0),s(p,null,h(B.value,(e,a)=>(m(),s("div",{key:a,class:"info-row"},[o("span",C,f(e.title),1),o("span",b,f(e.value),1)]))),128))])]),_:1},8,["show"]),u(l,{show:H.value,"onUpdate:show":n[2]||(n[2]=e=>H.value=e),position:"bottom"},{default:v(()=>[u(t,{columns:q.value,onConfirm:D,onCancel:n[1]||(n[1]=e=>H.value=!1),onChange:G},null,8,["columns"])]),_:1},8,["show"])])}}};"function"==typeof _&&_(E),e("default",i(E,[["__scopeId","data-v-d276d64c"]]))}}});
