import{u as J}from"./useTabsListener-CnvSNM1v.js";import{aB as F,d as x,j as P,r as d,l as z,w as N,o as M,g as U,a as g,F as S,h as i,G as T,U as q,k as L,m as b,au as k,b as f,i as O,ad as $,_ as B,aq as j,H as W,J as E,aD as I,c as G,aE as K,e as H}from"./index-5kp1FiRg.js";import{D as A}from"./Detail-CBGWh8FM.js";import{c as R}from"./config-BiPkORWZ.js";import{_ as Q}from"./HazardListSearchForm.vue_vue_type_script_setup_true_lang--1PMZZa9.js";/* empty css                                                               */async function X(m){return F.get("/ensafe/report_risk_list",{params:m})}async function Y(m){return F.get("/ensafe/check_record_list",{params:m})}async function Z(m){return F.get("/ensafe/risk_record_list",{params:m})}async function ee(m){return F.get("/ensafe/lisense_list",{params:m})}async function te(m){return F.get("/ensafe/accident_list",{params:m})}const ae=x({__name:"MyReportSearchForm",props:{form:{default:{}}},emits:["update:form"],setup(m,{emit:_}){const l=m,v=_;P(),d([]);const e=z({...l.form}),u=d([]),n=d([]);return N(e,t=>{v("update:form",t)},{deep:!0}),N(()=>l.form,t=>{Object.assign(e,t)},{deep:!0,immediate:!0}),M(()=>{u.value=[{value:1,text:"待审核"},{value:2,text:"确认"},{value:3,text:"退回"}],n.value=R.get("hidden_level_list").map(t=>({text:t.name,value:t.id}))}),(t,s)=>{const c=T,r=q;return g(),U(S,null,[i(c,{modelValue:e.location,"onUpdate:modelValue":s[0]||(s[0]=a=>e.location=a),type:"text",name:"text",label:"",placeholder:"请输入隐患地点"},null,8,["modelValue"]),i(c,{modelValue:e.desc,"onUpdate:modelValue":s[1]||(s[1]=a=>e.desc=a),type:"text",name:"text",label:"",placeholder:"请输入隐患描述"},null,8,["modelValue"]),i(r,{value:e.status,"onUpdate:value":s[2]||(s[2]=a=>e.status=a),placeholder:"状态",columns:u.value},null,8,["value","columns"])],64)}}}),le={class:"text-12px"},ne=x({__name:"MyReport",setup(m){const{routerPush:_}=L(),l=[{title:"地点",className:"created_at",key:"input_2",width:"30%"},{title:"隐患描述",key:"input_3",width:"30%"},{title:"状态",className:"three",key:"radio_6",width:"30%"}],v=[{status:0,name:"退回"},{status:1,name:"确认"},{status:2,name:"待审核"}],e=d({pageSize:30,name:"",sort:"zh",status:"",level:"",set_etp_id:"",start_date:"",end_date:"",location:"",desc:""});async function u({pageNum:c}={pageNum:1}){const r={page:c,...e.value},a=await X(r);return{total:Number(a.count)||0,data:a.data||[]}}const n=d(!1),t=d([]);function s(c){_("task-process",{taskid:"",transid:c.process_inst_id,appid:0})}return(c,r)=>{const a=B,o=A,h=j;return g(),U("div",null,[i(a,{form:f(e),"onUpdate:form":r[1]||(r[1]=y=>k(e)?e.value=y:null),columns:l,request:u,floating:[{icon:"search",key:"search"}],onOnRowClick:s},{"cell-radio_6":b(({row:y})=>{var C;return[O("div",le,$(((C=v.find(V=>V.status==y.radio_6))==null?void 0:C.name)||""),1)]}),searchForm:b(()=>[i(ae,{form:f(e),"onUpdate:form":r[0]||(r[0]=y=>k(e)?e.value=y:null)},null,8,["form"])]),_:1},8,["form"]),i(h,{show:f(n),"onUpdate:show":r[2]||(r[2]=y=>k(n)?n.value=y:null),position:"bottom",style:{height:"70%"}},{default:b(()=>[i(o,{items:f(t)},null,8,["items"])]),_:1},8,["show"])])}}}),se=x({__name:"MyCheckSearchForm",props:{form:{default:{}},checkTypeOptions:{}},emits:["update:form"],setup(m,{emit:_}){const l=m,v=_;P(),d([]);const e=z({...l.form}),u=d([]);return N(e,n=>{v("update:form",n)},{deep:!0}),N(()=>l.form,n=>{Object.assign(e,n)},{deep:!0,immediate:!0}),M(()=>{u.value=R.get("safety_check_status").map(n=>({text:n.name,value:n.id}))}),(n,t)=>{const s=T,c=q;return g(),U(S,null,[i(s,{modelValue:e.inspect_name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.inspect_name=r),type:"text",name:"text",label:"",placeholder:"请输入检查名称"},null,8,["modelValue"]),i(c,{value:e.status,"onUpdate:value":t[1]||(t[1]=r=>e.status=r),placeholder:"检查状态",columns:u.value},null,8,["value","columns"])],64)}}}),oe={class:"text-12px"},ue=x({__name:"MyCheck",setup(m){const{routerPush:_}=L(),l=d({page_size:30,inspect_name:"",inspect_type:0,status:-1,year:"",set_etp_id:"",type:void 0}),v=[{title:"检查名称",className:"three",key:"inspect_name",width:"50%",uname:"",type:"selection"},{title:"检查状态",className:"three",key:"status",uname:"",width:"20%",editable:!1,searchable:!1},{title:"操作",className:"three",key:"call",uname:"",width:"20%",editable:!1,searchable:!1}],e=[{status:0,name:"进行中"},{status:1,name:"已完成"},{status:2,name:"中止"}],u=d([]);async function n({pageNum:a}={pageNum:1}){const o={page:a,status:-1,...l.value},h=await Y(o);return u.value=(h.inspect_type||[]).map(y=>({text:y.title,value:y.node_id})),{total:Number(h.count)||0,data:h.data||[]}}function t(a){_("task-process",{task_id:0,app_id:12,param:"launch_check|4_".concat(a.process_inst_id)})}const s=d(!1),c=d([]);function r(a){var o;s.value=!0,c.value=[{label:"公司",value:a.etp_id_name},{label:"检查名称",value:a.inspect_name},{label:"检查类型",value:a.inspect_type},{label:"发起人",value:a.send},{label:"接收人",value:a.candidate},{label:"发送时间",value:a.send_time},{label:"计划完成时间",value:a.finished_time||"-"},{label:"处理状态",value:((o=e.find(h=>h.status==a.status))==null?void 0:o.name)||""},{label:"备注",value:a.remarks}]}return(a,o)=>{const h=W,y=B,C=A,V=j;return g(),U("div",null,[i(y,{columns:v,request:n,onOnRowClick:r,form:f(l),"onUpdate:form":o[1]||(o[1]=p=>k(l)?l.value=p:null),floating:[{icon:"search",key:"search"}]},{"cell-status":b(({row:p})=>{var w;return[O("div",oe,$(((w=e.find(D=>D.status==p.status))==null?void 0:w.name)||""),1)]}),"cell-call":b(({row:p})=>[i(h,{type:"primary",size:"small",onClick:w=>t(p)},{default:b(()=>[...o[3]||(o[3]=[E(" 调用 ",-1)])]),_:1},8,["onClick"])]),searchForm:b(()=>[i(se,{form:f(l),"onUpdate:form":o[0]||(o[0]=p=>k(l)?l.value=p:null),checkTypeOptions:f(u)},null,8,["form","checkTypeOptions"])]),_:1},8,["form"]),i(V,{show:f(s),"onUpdate:show":o[2]||(o[2]=p=>k(s)?s.value=p:null),position:"bottom",style:{height:"70%"}},{default:b(()=>[i(C,{items:f(c)},null,8,["items"])]),_:1},8,["show"])])}}}),re={class:"text-12px"},ie={class:"text-12px"},ce={class:"text-12px"},pe=x({__name:"MyRectification",setup(m){const{routerPush:_}=L(),l=[{title:"隐患地点",key:"place",width:"18%"},{title:"隐患描述",key:"desc",width:"18%"},{title:"隐患级别",key:"level",width:"18%"},{title:"状态",key:"status",width:"15%"},{title:"来源",key:"sources",width:"15%"}],v=[{value:10,label:"5S"},{value:11,label:"脚手搭设"},{value:12,label:"个人防护"},{value:13,label:"动能皮带"},{value:14,label:"脚手点检"},{value:15,label:"脚手定置"},{value:16,label:"定置管理"},{value:17,label:"安全用电"},{value:18,label:"管线架空"},{value:19,label:"设备设施"},{value:20,label:"作业安全"},{value:21,label:"设备点检"},{value:22,label:"安全监护"},{value:23,label:"私搭私拆"},{value:24,label:"目视管理"},{value:25,label:"作业审批"},{value:26,label:"通风照明"},{value:27,label:"脚手材料"},{value:28,label:"消防管理"},{value:29,label:"违章吸烟"},{value:30,label:"火灾"},{value:31,label:"皮带出舱"},{value:32,label:"攀爬脚手"},{value:33,label:"环保"},{value:34,label:"高空抛物"},{value:35,label:"其他"},{value:36,label:"设备保护"},{value:37,label:"跑冒滴漏"}],e=[{name:"",id:0},{name:"重大",id:1},{name:"较大",id:2},{name:"一般",id:3}],u=d({inspect_name:"",inspect_type:0,status:-1,sort:"zh",location:"",desc:"",level:"",set_etp_id:"",start_date:"",end_date:""});async function n({pageNum:a}={pageNum:1}){const o={...u.value,page:a},h=await Z(o);return{total:Number(h.count)||0,data:h.data||[]}}const t=d(!1),s=d([]);function c(a){var y;t.value=!0;let o=R.trans("zhenggai_status",a.status);a.status==0&&a.sign=="1"&&(o="超纳期");const h=[{label:"隐患地点",value:a.place},{label:"隐患级别",value:R.trans("hidden_level_list",a.level)},{label:"隐患描述",value:a.desc},{label:"整改要求及措施",value:a.fix_policy},{label:"责任部门",value:a.fixman_uid_department_id_depart_name},{label:"状态",value:o},{label:"隐患类别",value:((y=v.find(C=>C.value===a.risk_value))==null?void 0:y.label)||""},{label:"责任人",value:a.fixman_uid_user_name},{label:"整改纳期",value:a.need_fix_time},{label:"资金投入",value:a.money},{label:"整改验收人",value:a.fixman},{label:"发现地点",value:a.place},{label:"发现时间",value:a.find_time},{label:"整改前图片",value:a.before_image,renderType:"image"},{label:"整改后图片",value:a.after_image,renderType:"image"}];s.value=h}function r(a){_("task-process",{appid:0,transid:a.process_inst_id,task_id:a.id})}return(a,o)=>{const h=W,y=B,C=A,V=j;return g(),U("div",null,[i(y,{form:f(u),"onUpdate:form":o[1]||(o[1]=p=>k(u)?u.value=p:null),columns:l,request:n,floating:[{icon:"search",key:"search"}],onOnRowClick:c},{"cell-select_7":b(({row:p})=>{var w;return[O("div",re,$(((w=v.find(D=>D.value==p.risk_value))==null?void 0:w.label)||""),1)]}),"cell-level":b(({row:p})=>{var w;return[O("div",ie,$(((w=e.find(D=>D.id==p.level))==null?void 0:w.name)||""),1)]}),"cell-status":b(({row:p})=>[O("div",ce,$(p.status==="0"&&p.sign==="1"?"超纳期":f(R).trans("zhenggai_status",p.status)),1)]),"cell-sources":b(({row:p})=>[i(h,{type:"primary",size:"small",onClick:w=>r(p)},{default:b(()=>[...o[3]||(o[3]=[E(" 进度 ",-1)])]),_:1},8,["onClick"])]),searchForm:b(()=>[i(Q,{form:f(u),"onUpdate:form":o[0]||(o[0]=p=>k(u)?u.value=p:null)},null,8,["form"])]),_:1},8,["form"]),i(V,{show:f(t),"onUpdate:show":o[2]||(o[2]=p=>k(t)?t.value=p:null),position:"bottom",style:{height:"70%"}},{default:b(()=>[i(C,{items:f(s)},null,8,["items"])]),_:1},8,["show"])])}}}),me=x({__name:"MyWorkSearchForm",props:{form:{default:{}}},emits:["update:form"],setup(m,{emit:_}){const l=m,v=_;P(),d([]);const e=z({...l.form}),u=d([]);return N(e,n=>{v("update:form",n)},{deep:!0}),N(()=>l.form,n=>{Object.assign(e,n)},{deep:!0,immediate:!0}),M(()=>{u.value=["动火作业","受限空间作业","高处作业","临时用电作业","吊装作业","盲板抽堵作业","动土作业","断路作业"].map(n=>({value:n,text:n}))}),(n,t)=>{const s=q,c=T;return g(),U(S,null,[i(s,{value:e.name,"onUpdate:value":t[0]||(t[0]=r=>e.name=r),placeholder:"作业类型",columns:u.value},null,8,["value","columns"]),i(c,{modelValue:e.no,"onUpdate:modelValue":t[1]||(t[1]=r=>e.no=r),type:"text",name:"text",label:"",placeholder:"请输入作业编号"},null,8,["modelValue"])],64)}}}),de=x({__name:"MyWork",setup(m){const{routerPush:_}=L(),l=d({page_size:30,name:"",power_name:"",no:""}),v=[{title:"作业类型",className:"three",width:"40%",key:"type"},{title:"作业编号",width:"35%",key:"no"},{title:"申请人",key:"send_user_name"}];async function e({pageNum:n}={pageNum:1}){const t={page:n,department_id:0,level:0,sign:2,my_self:1,...l.value},s=await ee(t);return{total:Number(s.count)||0,data:s.data||[]}}function u(n){_("task-process",{app_id:8,transid:n.process_inst_id})}return(n,t)=>{const s=B;return g(),U("div",null,[i(s,{form:f(l),"onUpdate:form":t[1]||(t[1]=c=>k(l)?l.value=c:null),columns:v,request:e,floating:[{icon:"search",key:"search"}],onOnRowClick:u},{searchForm:b(()=>[i(me,{form:f(l),"onUpdate:form":t[0]||(t[0]=c=>k(l)?l.value=c:null)},null,8,["form"])]),_:1},8,["form"])])}}}),_e=x({__name:"AccidentSearchForm",props:{form:{default:{}}},emits:["update:form"],setup(m,{emit:_}){const l=m,v=_,e=z({...l.form}),u=d([]);return N(e,n=>{v("update:form",n)},{deep:!0}),N(()=>l.form,n=>{Object.assign(e,n)},{deep:!0,immediate:!0}),M(()=>{u.value=R.get("accident_type").map(n=>({text:n.name,value:n.id}))}),(n,t)=>{const s=T,c=q;return g(),U(S,null,[i(s,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.name=r),type:"text",name:"text",label:"",placeholder:"请输入事故名称"},null,8,["modelValue"]),i(c,{value:e.types,"onUpdate:value":t[1]||(t[1]=r=>e.types=r),placeholder:"事故类型",columns:u.value},null,8,["value","columns"]),i(s,{modelValue:e.staff_name,"onUpdate:modelValue":t[2]||(t[2]=r=>e.staff_name=r),type:"text",name:"text",label:"",placeholder:"请输入责任人名称"},null,8,["modelValue"])],64)}}}),ve=x({__name:"AccidentHandling",setup(m){const _=[{title:"事故名称",className:"three",key:"input_1",width:"30%",uname:"",type:"selection"},{title:"事故地点",className:"three",key:"input_location",uname:"",width:"30%",editable:!1,searchable:!1},{title:"事故时间",className:"three",key:"date_2",uname:"",width:"30%",editable:!1,searchable:!1}],l=d({type:0,types:"",name:"",staff_name:"",doc_type:1,set_etp_id:""});async function v({pageNum:t}={pageNum:1}){const s={page:t,...l.value},c=await te(s);return{total:Number(c.count)||0,data:c.data||[]}}const e=d(!1),u=d([]);function n(t){e.value=!0,u.value=[{label:"公司",value:t.etp_id_name},{label:"事故时间",value:t.date_2},{label:"事故名称",value:t.input_1},{label:"事故类型",value:R.trans("accident_type",t.select_3)},{label:"整改措施",value:t.input_4},{label:"责任人",value:t.treeselect_5},{label:"备注",value:t.input_8},{label:"附件",value:JSON.parse(t.upload_10),renderType:"image"}]}return(t,s)=>{const c=B,r=A,a=j;return g(),U("div",null,[i(c,{form:f(l),"onUpdate:form":s[1]||(s[1]=o=>k(l)?l.value=o:null),columns:_,request:v,floating:[{icon:"search",key:"search"}],onOnRowClick:n},{searchForm:b(()=>[i(_e,{form:f(l),"onUpdate:form":s[0]||(s[0]=o=>k(l)?l.value=o:null)},null,8,["form"])]),_:1},8,["form"]),i(a,{show:f(e),"onUpdate:show":s[2]||(s[2]=o=>k(e)?e.value=o:null),position:"bottom",style:{height:"70%"}},{default:b(()=>[i(r,{items:f(u)},null,8,["items"])]),_:1},8,["show"])])}}}),fe={class:"flex-center h-[100vh] w-100% items-center"},be=x({__name:"index",setup(m){const _=d("basic");J("securityAffairs-tab",e=>{_.value=e.name});const l=I(()=>({myReport:ne,myCheck:ue,myRectification:pe,myWork:de,accidentHandling:ve})),v=I(()=>l.value[_.value]||null);return(e,u)=>(g(),U("div",fe,[(g(),G(K(v.value)))]))}});typeof H=="function"&&H(be);export{be as default};
