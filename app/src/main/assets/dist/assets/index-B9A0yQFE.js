import{u as O}from"./useTabsListener-CnvSNM1v.js";import{d as S,j as $,r as u,l as q,w as N,o as R,c as k,a as c,G as j,k as F,g as x,h as v,m as y,au as g,b as m,i as t,av as T,ad as l,_ as U,F as w,E as C,H as E,J as G,aq as H,y as J,e as L}from"./index-5kp1FiRg.js";import{g as M,a as A}from"./keyControlMeasures-CHju10qt.js";import{c as I}from"./config-BiPkORWZ.js";const V=S({__name:"SearchForm",props:{form:{default:{}}},emits:["update:form"],setup(b,{emit:d}){const a=b,_=d;$();const f=u([]);u([]),u([]),u({label:"title",value:"node_id",children:"child"});const r=q({...a.form});return N(r,o=>{_("update:form",o)},{deep:!0}),N(()=>a.form,o=>{Object.assign(r,o)},{deep:!0,immediate:!0}),R(()=>{f.value=I.get("risk_type").map(o=>({text:o.name,value:o.id}))}),(o,i)=>{const s=j;return c(),k(s,{modelValue:r.name,"onUpdate:modelValue":i[0]||(i[0]=e=>r.name=e),type:"text",name:"text",placeholder:"请输入名称"},null,8,["modelValue"])}}}),K={class:"p-[10px] relative"},Q={class:"pr-[4px] h-[calc(100%-50px)] overflow-y-auto"},W={class:"text-[14px] text-blue-500 mb-[2px] pl-[2px]"},X={class:"gap-2 grid grid-cols-2"},Y={class:"flex flex-col"},Z={class:"text-[14px]"},ee={class:"flex flex-col"},te={class:"text-[14px]"},se={class:"flex flex-col"},ae={class:"text-[14px]"},oe={class:"flex flex-col"},le={class:"text-[14px]"},ne={class:"flex flex-col"},re={class:"text-[14px]"},ie={class:"flex flex-col"},pe={class:"text-[14px]"},ce={class:"flex flex-col"},de={class:"text-[14px]"},ue={class:"flex flex-col"},me={class:"text-[14px]"},_e={class:"flex flex-col"},xe={class:"text-[14px]"},fe={class:"flex flex-col"},ve={class:"text-[14px]"},ye={class:"flex flex-col"},ge={class:"text-[14px]"},be={__name:"LimitedSpaceLedger",setup(b){const{routerPush:d}=F(),a=u({page:1,pageSize:30,name:""}),_=[{title:"有限空间名称",className:"three",key:"limited_space_name",uname:"",width:"30%",type:"selection"},{title:"位置",className:"three",key:"location",width:"20%",uname:"",type:"selection"},{title:"可能导致事故",className:"three",key:"possible_accidents",uname:"",width:"20%",type:"selection"},{title:"责任人",className:"three",key:"responsible_person_user_name",width:"18%"}];async function f({pageNum:s}={pageNum:1}){const e={...a.value,page:s,total:0},h=await M(e);return{total:Number(h.count)||0,data:h.data||[]}}const r=u(!1),o=u({});function i(s){const e=[{value:s.limited_space_name,label:"有限空间名称"},{value:s.number,label:"编号"},{value:s.risk_factors,label:"危险因素"},{value:s.possible_accidents,label:"可能导致的事故"},{value:s.safety_protection_measures,label:"安全防护措施"},{value:s.location,label:"位置"},{value:s.emergency_measures,label:"应急措施"},{value:s.account,label:"工号"},{value:s.note,label:"备注"},{value:s.responsible_person_user_name,label:"责任人"},{value:s.files,label:"附件",renderType:"image"}];d("doublePreventionDetail",{detail:JSON.stringify(e)})}return(s,e)=>{const h=U,P=E,z=H;return c(),x(w,null,[v(h,{columns:_,request:f,onOnRowClick:i,form:m(a),"onUpdate:form":e[1]||(e[1]=n=>g(a)?a.value=n:null),floating:[{icon:"search",key:"search"}]},{"cell-level_name":y(({row:n})=>[t("div",{class:"text-12 text-white px-2 py-1 rounded",style:T({color:s.levelColor[n.level_id].color||"#ccc"})},l(s.levelColor[n.level_id].label),5)]),searchForm:y(()=>[v(V,{form:m(a),"onUpdate:form":e[0]||(e[0]=n=>g(a)?a.value=n:null)},null,8,["form"])]),_:1},8,["form"]),v(z,{show:m(r),"onUpdate:show":e[3]||(e[3]=n=>g(r)?r.value=n:null),position:"bottom",round:"",style:{height:"80%"}},{default:y(()=>[t("div",K,[e[16]||(e[16]=t("div",{class:"text-[16px] font-bold mb-[4px] bg-white top-0 sticky"}," 管控措施 ",-1)),t("div",Q,[(c(!0),x(w,null,C(m(o),(n,B)=>(c(),x("div",{key:B,class:"mb-[6px]"},[t("div",W," 检查项目："+l(n.task_step),1),(c(!0),x(w,null,C(n.policy,(p,D)=>(c(),x("div",{key:D,class:"mb-[4px] p-[2px] border border-gray-300 rounded-lg"},[t("div",X,[t("div",Y,[e[4]||(e[4]=t("span",{class:"text-[14px] text-gray-500"},"危险源",-1)),t("span",Z,l(p.risk_name_id),1)]),t("div",ee,[e[5]||(e[5]=t("span",{class:"text-[14px] text-gray-500"},"风险值",-1)),t("span",te,l(p.level_num),1)]),t("div",se,[e[6]||(e[6]=t("span",{class:"text-[14px] text-gray-500"},"风险等级",-1)),t("span",ae,l(p.level_id),1)]),t("div",oe,[e[7]||(e[7]=t("span",{class:"text-[14px] text-gray-500"},"主要后果",-1)),t("span",le,l(p.main_res),1)]),t("div",ne,[e[8]||(e[8]=t("span",{class:"text-[14px] text-gray-500"},"工程措施",-1)),t("span",re,l(p.project_policy),1)]),t("div",ie,[e[9]||(e[9]=t("span",{class:"text-[14px] text-gray-500"},"教育培训措施",-1)),t("span",pe,l(p.stardard),1)]),t("div",ce,[e[10]||(e[10]=t("span",{class:"text-[14px] text-gray-500"},"管理措施",-1)),t("span",de,l(p.policy),1)]),t("div",ue,[e[11]||(e[11]=t("span",{class:"text-[14px] text-gray-500"},"个人安全措施",-1)),t("span",me,l(p.safe_policy),1)]),t("div",_e,[e[12]||(e[12]=t("span",{class:"text-[14px] text-gray-500"},"应急处置措施",-1)),t("span",xe,l(p.emergency_policy),1)]),t("div",fe,[e[13]||(e[13]=t("span",{class:"text-[14px] text-gray-500"},"管控层级",-1)),t("span",ve,l(p.control_name),1)]),t("div",ye,[e[14]||(e[14]=t("span",{class:"text-[14px] text-gray-500"},"检查频次",-1)),t("span",ge,l(p.frequency),1)])])]))),128))]))),128))]),v(P,{block:"",type:"primary",class:"mt-4",onClick:e[2]||(e[2]=n=>r.value=!1)},{default:y(()=>[...e[15]||(e[15]=[G(" 关闭 ",-1)])]),_:1})])]),_:1},8,["show"])],64)}}},he={__name:"HazardousChemicalsLedger",setup(b){const{routerPush:d}=F(),a=u({page:1,pageSize:30,name:""}),_=[{title:"部门",className:"three",key:"department_name",uname:"",width:150,type:"selection"},{title:"危化品名称",className:"three",key:"name",uname:"",width:150,type:"selection"},{title:"所在区域",className:"three",key:"area_name",width:100,uname:"",type:"selection"}];async function f({pageNum:o}={pageNum:1}){const i={...a.value,page:o,department_id:0,type:4},s=await A(i);return{total:Number(s.count)||0,data:s.data||[]}}const r=o=>{d("controlDetail",{id:o.id})};return(o,i)=>{const s=U;return c(),k(s,{columns:_,request:f,onOnRowClick:r,form:m(a),"onUpdate:form":i[1]||(i[1]=e=>g(a)?a.value=e:null),floating:[{icon:"search",key:"search"}]},{searchForm:y(()=>[v(V,{form:m(a),"onUpdate:form":i[0]||(i[0]=e=>g(a)?a.value=e:null)},null,8,["form"])]),_:1},8,["form"])}}},ke={class:"flex-center h-[100vh] w-100% items-center relative"},we=S({__name:"index",setup(b){const d=u("limitedSpaceLedger");return O("keyControl-click-tab",a=>{d.value=a.name}),(a,_)=>(c(),x("div",ke,[m(d)==="limitedSpaceLedger"?(c(),k(be,{key:0})):m(d)==="hazardousChemicalsLedger"?(c(),k(he,{key:1})):J("",!0)]))}});typeof L=="function"&&L(we);export{we as default};
