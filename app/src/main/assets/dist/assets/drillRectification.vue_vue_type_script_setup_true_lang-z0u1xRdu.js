import{aB as x,d as h,j as C,l as D,r as u,w as y,o as F,g as O,a as k,h as f,G as S,U,F as B,k as N,c as R,m as g,au as b,b as m,i as V,ad as j,_ as q}from"./index-5kp1FiRg.js";import{c as v}from"./config-BiPkORWZ.js";import{a as J}from"./index-BpTLWCN6.js";async function L(s){return x.get("/ensafe/accident_list",{params:s})}const $=h({__name:"SearchForm",props:{form:{default:{}}},emits:["update:form"],setup(s,{emit:p}){const r=s,l=p,d=C(),o=D({...r.form}),c=u([]),a=u([]);u({label:"title",value:"node_id",children:"child"});async function n(){const{etp_id:t}=d.userInfo,e=await J({id:t,deep:2,enbase:1,is_node:1});a.value=e||[]}return y(o,t=>{l("update:form",t)},{deep:!0}),y(()=>r.form,t=>{Object.assign(o,t)},{deep:!0,immediate:!0}),F(()=>{n(),c.value=v.get("accident_type").map(t=>({text:t.name,value:t.id}))}),(t,e)=>{const i=S,w=U;return k(),O(B,null,[f(i,{modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=_=>o.name=_),type:"text",name:"text",label:"",placeholder:"请输入名称"},null,8,["modelValue"]),f(w,{value:o.types,"onUpdate:value":e[1]||(e[1]=_=>o.types=_),placeholder:"事故类型",columns:c.value},null,8,["value","columns"])],64)}}}),I=h({__name:"drillRectification",setup(s){async function p({pageNum:a,form:n}){var e,i;const t=await L({page:a,...n,department_id:(i=(e=n.department_id)==null?void 0:e[0])==null?void 0:i.value});return{total:Number(t.count),data:t.data}}const{routerPush:r}=N(),l=u({type:0,types:"",name:"",doc_type:1,set_etp_id:"",year:""}),d=[{icon:"search",key:"search"}];function o(a){const n=[{label:"公司",value:a.etp_id_name},{label:"事故时间",value:a.date_2},{label:"事故名称",value:a.input_1},{label:"事故类型",value:v.trans("accident_type",a.select_3)},{label:"整改措施",value:a.input_4},{label:"责任人",value:a.treeselect_5},{label:"备注",value:a.input_8},{label:"附件",value:JSON.parse(a.upload_10),renderType:"image"}];r("emergencyDetail",{detail:JSON.stringify(n)})}const c=[{title:"名称",key:"input_1",width:"22%"},{title:"整改措施",key:"input_4",width:"20%"},{title:"事故类型",key:"select_3",width:"20%"},{title:"事故时间",key:"date_2",width:"21%"}];return(a,n)=>{const t=q;return k(),R(t,{form:m(l),"onUpdate:form":n[1]||(n[1]=e=>b(l)?l.value=e:null),columns:c,request:p,floating:d,onOnRowClick:o},{"cell-select_3":g(({row:e})=>[V("div",null,j(m(v).trans("accident_type",e.select_3)),1)]),searchForm:g(()=>[f($,{form:m(l),"onUpdate:form":n[0]||(n[0]=e=>b(l)?l.value=e:null)},null,8,["form"])]),_:1},8,["form"])}}});export{I as _};
