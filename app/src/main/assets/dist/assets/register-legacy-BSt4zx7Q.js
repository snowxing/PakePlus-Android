System.register(["./index-legacy-CK9unWWd.js","./v-uploader.vue_vue_type_script_setup_true_lang-legacy-DykKa8ts.js"],function(e,l){"use strict";var a,n,o,s,t,u,d,r,i,m,c,p,y,v,g,_,b,f,h,w,x,V,q,T,U,k,C;return{setters:[e=>{a=e.d,n=e.f,o=e.j,s=e.r,t=e.l,u=e.aD,d=e.a6,r=e.g,i=e.a,m=e.h,c=e.m,p=e.i,y=e.G,v=e.b,g=e.H,_=e.J,b=e.ad,f=e.a2,h=e.a_,w=e.au,x=e.aq,V=e.bc,q=e.bf,T=e.bs,U=e.bt,k=e.e},e=>{C=e._}],execute:function(){const l={class:"m-x-a text-center w-7xl",style:{padding:"20px 0"}},M={class:"mt-16 rounded-3xl overflow-hidden"},j={class:"mt-16 rounded-3xl overflow-hidden"},I={class:"mt-16 rounded-3xl overflow-hidden"},O={class:"mt-16 rounded-3xl overflow-hidden"},S={class:"mt-16 rounded-3xl overflow-hidden"},$={class:"mt-16 rounded-3xl overflow-hidden"},E={class:"mt-16 rounded-3xl overflow-hidden"},N={class:"mt-32"},P=e("default",a({__name:"register",setup(e){const a=n(),k=o(),P=s(!1),z=s(!1),D=s(!1),F=t({userType:"",company_name:"",company_license:[],company_industry:"",name:"",mobile:"",code:""}),G=s(null),H=[{text:"企业用户",value:"1",disabled:!1},{text:"安全专家",value:"2",disabled:!0}],J=[{text:"化工",value:1},{text:"工贸",value:2}],R=t({userType:[{required:!0,message:"请选择用户类型"}],company_name:[{required:!0,message:"请输入公司名称"}],company_industry:[{required:!0,message:"请选择行业"}],name:[{required:!0,message:"请输入姓名"}],mobile:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],code:[{required:!0,message:"请输入验证码"}]});function A(e){F.company_industry=e.selectedOptions[0].text,G.value=e.selectedOptions[0].value,z.value=!1}function B(e){F.userType=e.selectedOptions[0].text,D.value=!1}async function K(){console.log(F.company_license);const e=k.getEidUser();try{P.value=!0;const n={user_type:F.userType,company_name:F.company_name,company_license:F.company_license.length>0?F.company_license.join(","):"",company_industry:Number(G.value),name:F.name,mobile:F.mobile,code:F.code,eid:e.eid},o=await T(n);if(console.log(o),1==o.status){V({type:"success",message:"注册成功"});try{const e=await U({mobile:F.mobile});k.setInfo(e),k.setToken(e.token),await k.setMenus(),k.activeOnlineTimer();let{redirect:l,...n}=a.currentRoute.value.query;"404"===l&&(l="chatPage"),a.push({name:l||"chatPage",query:{...n}})}catch(l){throw k.clearToken(),V(l),l}}else V({type:"danger",message:o.message||"注册失败"})}catch(l){V({type:"danger",message:l.message||"注册失败"})}finally{P.value=!1}}const L=s(!1),Q=s(0);let W=null;const X=u(()=>Q.value>0?`${Q.value}秒后重新获取`:L.value?"获取中...":"获取验证码");async function Y(){if(F.mobile)if(/^1[3-9]\d{9}$/.test(F.mobile)){L.value=!0;try{const e=await q({type:1,mobile:Number(F.mobile)});1==e?(V({type:"success",message:"验证码已发送"}),Q.value=120,W=setInterval(()=>{Q.value--,Q.value<=0&&clearInterval(W)},1e3)):V({type:"danger",message:e.message||"获取验证码失败"})}catch(e){V({type:"danger",message:e.message||"获取验证码失败"})}finally{L.value=!1}}else V({type:"warning",message:"请输入正确的手机号"});else V({type:"warning",message:"请输入手机号"})}function Z(e){console.log(e),F.company_license=e}return d(()=>{k.setEidUser({}),W&&clearInterval(W)}),(e,a)=>{const n=y,o=g,s=f,t=h,u=x;return i(),r("div",l,[m(s,{model:v(F),rules:v(R),"validate-trigger":"onSubmit",onSubmit:K},{default:c(()=>[p("div",M,[m(n,{modelValue:v(F).userType,"onUpdate:modelValue":a[0]||(a[0]=e=>v(F).userType=e),rules:v(R).userType,required:"",name:"userType",label:"用户类型","is-link":"",readonly:"",placeholder:"请选择用户类型",onClick:a[1]||(a[1]=e=>D.value=!0)},null,8,["modelValue","rules"])]),p("div",j,[m(n,{modelValue:v(F).company_name,"onUpdate:modelValue":a[2]||(a[2]=e=>v(F).company_name=e),modelModifiers:{trim:!0},required:"",rules:v(R).company_name,name:"company_name",label:"公司名称",placeholder:"请输入公司名称"},null,8,["modelValue","rules"])]),p("div",I,[m(n,{name:"company_license",label:"营业执照"},{input:c(()=>[m(C,{value:v(F).company_license,"onUpdate:value":[a[3]||(a[3]=e=>v(F).company_license=e),Z]},null,8,["value"])]),_:1})]),p("div",O,[m(n,{modelValue:v(F).company_industry,"onUpdate:modelValue":a[4]||(a[4]=e=>v(F).company_industry=e),rules:v(R).company_industry,required:"",name:"company_industry",label:"行业","is-link":"",readonly:"",placeholder:"请选择行业",onClick:a[5]||(a[5]=e=>z.value=!0)},null,8,["modelValue","rules"])]),p("div",S,[m(n,{modelValue:v(F).name,"onUpdate:modelValue":a[6]||(a[6]=e=>v(F).name=e),modelModifiers:{trim:!0},rules:v(R).name,required:"",name:"name",label:"姓名",placeholder:"请输入姓名"},null,8,["modelValue","rules"])]),p("div",$,[m(n,{modelValue:v(F).mobile,"onUpdate:modelValue":a[7]||(a[7]=e=>v(F).mobile=e),modelModifiers:{trim:!0},rules:v(R).mobile,required:"",name:"mobile",label:"手机号",type:"tel",maxlength:"11",placeholder:"请输入手机号"},null,8,["modelValue","rules"])]),p("div",E,[m(n,{modelValue:v(F).code,"onUpdate:modelValue":a[8]||(a[8]=e=>v(F).code=e),modelModifiers:{trim:!0},rules:v(R).code,required:"",name:"code",label:"验证码",placeholder:"请输入验证码"},{button:c(()=>[m(o,{size:"small",type:"primary",plain:"",disabled:v(Q)>0||v(L),onClick:Y},{default:c(()=>[_(b(v(X)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue","rules"])]),p("div",N,[m(o,{loading:v(P),type:"primary","native-type":"submit",round:"",block:""},{default:c(()=>[...a[13]||(a[13]=[_(" 注册 ",-1)])]),_:1},8,["loading"])])]),_:1},8,["model","rules"]),m(u,{show:v(z),"onUpdate:show":a[10]||(a[10]=e=>w(z)?z.value=e:null),position:"bottom"},{default:c(()=>[m(t,{columns:J,onConfirm:A,onCancel:a[9]||(a[9]=e=>z.value=!1)})]),_:1},8,["show"]),m(u,{show:v(D),"onUpdate:show":a[12]||(a[12]=e=>w(D)?D.value=e:null),position:"bottom"},{default:c(()=>[m(t,{columns:H,onConfirm:B,onCancel:a[11]||(a[11]=e=>D.value=!1)})]),_:1},8,["show"])])}}}));"function"==typeof k&&k(P)}}});
