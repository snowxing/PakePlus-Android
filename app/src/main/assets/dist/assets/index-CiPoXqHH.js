import{d as D,f as I,j as N,r as m,l as h,aD as M,a6 as R,o as E,g as T,a as $,i as r,h as s,b as e,a9 as j,m as c,G as z,H as F,J as w,ad as G,a2 as P,bc as f,bf as Q,v as H,e as x}from"./index-5kp1FiRg.js";import{l as J}from"./login-CLb8_qLw.js";const L=""+new URL("logo1-sMjQXvfZ.png",import.meta.url).href,O={class:"m-x-a text-center w-7xl"},X={class:"mb-32 mt-20"},Z={class:"rounded-3xl overflow-hidden"},A={class:"mt-16 rounded-3xl overflow-hidden"},K={class:"mt-16"},V=D({__name:"index",setup(W){const b=I(),i=N(),v=m(!1);m(!1);const a=h({mobile:"",code:""}),y=h({mobile:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],code:[{required:!0,message:"请输入验证码"}]}),d=m(!1),l=m(0);let g=null;m(!1);const C=M(()=>l.value>0?"".concat(l.value,"秒后重新获取"):d.value?"获取中...":"获取验证码");async function S(){if(!a.mobile){f({type:"warning",message:"请输入手机号"});return}if(!/^1[3-9]\d{9}$/.test(a.mobile)){f({type:"warning",message:"请输入正确的手机号"});return}d.value=!0;try{const o=await Q({type:3,mobile:Number(a.mobile)});console.log(o),o==1?(f({type:"success",message:"验证码已发送，请注意查收短信"}),U()):f({type:"danger",message:o.message||"获取验证码失败"})}catch(o){f({type:"danger",message:o.message||"获取验证码失败"})}finally{d.value=!1}}function U(){l.value=120,g=setInterval(()=>{l.value--,l.value<=0&&clearInterval(g)},1e3)}R(()=>{g&&clearInterval(g)});function k(){b.push({name:"new-register"})}E(async()=>{i.setEidUser({})});async function q(o){try{const t=i.getEidUser(),p={mobile:o.mobile,code:o.code,eid:t.eid};v.value=!0,await i.newSigninSms(p),await i.setMenus(),i.activeOnlineTimer();let{redirect:n,...u}=b.currentRoute.value.query;n==="404"&&(n="chatPage"),b.push({name:n||"chatPage",query:{...u}})}finally{v.value=!1}}return(o,t)=>{const p=j,n=z,u=F,B=P;return $(),T("div",O,[r("div",X,[s(p,{src:e(L),class:"h-60 w-60",alt:"brand logo"},null,8,["src"]),t[2]||(t[2]=r("div",{style:{color:"#008fd7","font-weight":"900","font-style":"italic"}}," DeepSafety ",-1))]),s(B,{model:e(a),rules:e(y),"validate-trigger":"onSubmit",onSubmit:q},{default:c(()=>[r("div",Z,[s(n,{modelValue:e(a).mobile,"onUpdate:modelValue":t[0]||(t[0]=_=>e(a).mobile=_),label:"手机号",required:"",rules:e(y).mobile,name:"mobile",placeholder:"请输入手机号"},null,8,["modelValue","rules"])]),r("div",A,[s(n,{modelValue:e(a).code,"onUpdate:modelValue":t[1]||(t[1]=_=>e(a).code=_),modelModifiers:{trim:!0},rules:e(y).code,required:"",name:"code",label:"验证码",placeholder:"请输入验证码"},{button:c(()=>[s(u,{size:"small",type:"primary",plain:"",disabled:e(l)>0||e(d),loading:e(d),onClick:S},{default:c(()=>[w(G(e(C)),1)]),_:1},8,["disabled","loading"])]),_:1},8,["modelValue","rules"])]),r("div",K,[s(u,{loading:e(v),type:"primary","native-type":"submit",round:"",block:""},{default:c(()=>[...t[3]||(t[3]=[w(" 登录 ",-1)])]),_:1},8,["loading"])])]),_:1},8,["model","rules"]),s(u,{class:"no-boder-button",size:"small",plain:"",type:"primary",onClick:k},{default:c(()=>[...t[4]||(t[4]=[w(" 还没有账号？点击注册 ",-1)])]),_:1}),r("div",null,[s(p,{class:"mt-16 h-196 w-256",src:e(J),fit:"cover",alt:"login background"},null,8,["src"])])])}}});typeof x=="function"&&x(V);const te=H(V,[["__scopeId","data-v-a5fbaf85"]]);export{te as default};
