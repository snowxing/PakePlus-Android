import{d as w,l as k,r as d,w as v,c as j,a as x,b as r,G as C,k as S,j as D,o as F,g as J,h as g,m as _,au as h,i as V,ad as B,_ as T,e as b}from"./index-5kp1FiRg.js";import{a as U,b as L}from"./index-DpOfbo4u.js";import{a as P}from"./index-BpTLWCN6.js";const R=w({__name:"meetSearchForm",props:{form:{default:()=>({})}},emits:["update:form"],setup(y,{emit:n}){const o=y,c=n,s=k({...o.form});return d([{text:"待开会",value:"1"},{text:"会议中",value:"2"},{text:"已结束",value:"3"}]),v(s,i=>{c("update:form",i)},{deep:!0}),v(()=>o.form,i=>{Object.assign(s,i)},{deep:!0,immediate:!0}),(i,t)=>{const p=C;return x(),j(p,{modelValue:r(s).name,"onUpdate:modelValue":t[0]||(t[0]=m=>r(s).name=m),type:"text",name:"text",label:"",placeholder:"请输入名称"},null,8,["modelValue"])}}}),z={class:"todo-list"},G={class:"text-12px"},H=w({__name:"decisionMakingMeetings",setup(y){const{routerPush:n}=S(),o=D(),c=[{title:"名称",key:"name",width:"30%"},{title:"议题",key:"subject",width:"50%"},{title:"状态",key:"status",width:"15%"}],s=d([]),i=[{label:"待开会",value:"1"},{label:"会议中",value:"2"},{label:"已结束",value:"3"}],t=d({name:"",status:"",subject:"",pageNum:1,pageSize:30}),p=k([{icon:"search",key:"search"}]),m=d([]);async function q({pageNum:a}){const e=await U({page:a,...t.value})||{};return{total:Number(e.count||0),data:e.data||[]}}async function M(a){var l;const e=await L({id:a.id})||{},f=[{label:"会议名称",value:e.name},{label:"会议类型",value:e.type_name},{label:"会议议题",value:e.subject},{label:"会议时间",value:e.begin_time},{label:"会议地点",value:e.room},{label:"会议发起人",value:e.sponsor_staff_id_user_name},{label:"会议主持人",value:e.executive_staff_user_name},{label:"与会人员",value:e.staff.name},{label:"会议状态",value:((l=i.find(u=>u.value===e.status))==null?void 0:l.label)||""},{label:"决议结论",value:e.decision},{label:"备注",value:e.note},{label:"附件",value:JSON.parse((e==null?void 0:e.files)||"[]").length>0?e.files:"无",renderType:"image"}];n("institutionalizedDetail",{detail:JSON.stringify(f)})}function N(a){if(a.key==="add"){const e=[{field:"name",style:{width:"100%"},title:"会议名称",type:"input",props:{placeholder:"请输入"},validate:[{message:"会议名称必须填写",required:!0,type:"string"}],value:""},{field:"type_id",style:{width:"100%"},options:s.value,props:{multiple:!1,placeholder:"会议类型"},validate:[{message:"会议类型必须填写",required:!0,type:"string"}],title:"会议类型",type:"select",value:[]},{field:"room",style:{width:"100%"},title:"会议地点",type:"input",props:{placeholder:"请输入"},validate:[{message:"会议地点必须填写",required:!0,type:"string"}],value:""},{field:"begin_time",props:{type:"date",format:"yyyy-MM-dd-HH:mm:ss",placeholder:"请选择"},validate:[{type:"string",message:"选择时间",required:!0}],style:{width:"100%"},title:"会议时间",type:"date",value:""},{field:"sponsor_staff_id",style:{width:"100%"},options:[],props:{multiple:!1,placeholder:"会议发起人",source:"staff"},validate:[{message:"会议发起人必须填写",required:!0,type:"string"}],title:"会议发起人",type:"treeselect",value:[]},{field:"executive_staff",style:{width:"100%"},options:[],props:{multiple:!1,placeholder:"会议主持人",source:"staff"},validate:[{message:"会议主持人必须填写",required:!0,type:"string"}],title:"会议主持人",type:"treeselect",value:[]},{field:"staff",style:{width:"100%"},options:[],props:{multiple:!0,placeholder:"与会人员",source:"staff"},validate:[{message:"与会人员必须填写",required:!0,type:"string"}],title:"与会人员",type:"treeselect",value:[]},{field:"status",style:{width:"100%"},options:[{label:"待开会",value:1},{label:"会议中",value:2},{label:"已结束",value:3}],props:{multiple:!1,placeholder:"会议状态"},validate:[{message:"会议状态必须填写",required:!0,type:"string"}],title:"会议状态",type:"select",value:[]},{field:"subject",style:{width:"100%"},title:"会议主题",type:"input",props:{placeholder:"请输入"},validate:[{message:"会议主题必须填写",required:!0,type:"string"}],value:""},{field:"decision",style:{width:"100%"},title:"会议结论",type:"textarea",props:{placeholder:"请输入"},validate:{type:"string"},value:""},{field:"note",style:{width:"100%"},title:"备注",type:"textarea",props:{placeholder:"请输入"},validate:{type:"string"},value:""},{field:"files",title:"附件",type:"upload",value:[]},{type:"static",field:"formbutton",row:[{title:"提交",value:0,type:"button",field:"submit",props:{type:"primary",post_id:[],node_id:0,actionKey:"meeting_edit"},style:{"margin-right":"20px","padding-left":"12px","padding-right":"12px"},col:{span:4}}]}];n("task-process",{formJson:JSON.stringify({forms:e})})}}return F(()=>{P({is_node:"0",id:"YTLX",deep:1,enbase:1}).then(a=>{s.value=a.map(e=>({value:e.node_id,label:e.title}))}),o!=null&&o.getPri("decision-making-meeting-list",1)&&p.unshift({icon:"plus",key:"add"})}),(a,e)=>{const f=T;return x(),J("div",z,[g(f,{form:r(t),"onUpdate:form":e[1]||(e[1]=l=>h(t)?t.value=l:null),columns:c,request:q,floating:r(p),onOnRowClick:M,onOnFloatingClick:N},{"cell-status":_(({row:l})=>{var u;return[V("div",G,B(((u=i.find(O=>O.value===l.status))==null?void 0:u.label)||""),1)]}),searchForm:_(()=>[g(R,{form:r(t),"onUpdate:form":e[0]||(e[0]=l=>h(t)?t.value=l:null),"check-type-options":r(m)},null,8,["form","check-type-options"])]),_:1},8,["form","floating"])])}}});typeof b=="function"&&b(H);export{H as default};
