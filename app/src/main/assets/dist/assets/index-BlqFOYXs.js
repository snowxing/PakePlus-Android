import{u as L}from"./useTabsListener-CnvSNM1v.js";import{d as g,r as f,l as U,w as x,o as w,g as k,a as d,h as m,b as i,G as j,U as D,F,j as O,k as S,c as N,m as _,au as h,H as $,b0 as P,J as T,i as z,ad as M,_ as B,aS as q,aD as V,aE as E,e as C}from"./index-5kp1FiRg.js";import{g as J}from"./ViolationRecord-DAgy-Ljm.js";import{c as K}from"./config-BiPkORWZ.js";import{a as R}from"./index-BpTLWCN6.js";import{g as A}from"./workRequest-DyiUB1zZ.js";const G=g({__name:"SearchForm",props:{form:{default:()=>({})},dataKey:{default:{year:"implement_year",obj_id:"obj_id"}}},emits:["update:form"],setup(y,{emit:r}){const n=y,p=r,l=f([]),c=f([{text:"进行中",value:1},{text:"已完成",value:2}]),o=U({...n.form});return x(o,e=>{p("update:form",e)},{deep:!0}),x(()=>n.form,e=>{Object.assign(o,e)},{deep:!0,immediate:!0}),w(()=>{R({is_node:"0",id:"914682",deep:1,enbase:1}).then(e=>{l.value=e.map(t=>({text:t.title,value:t.node_id}))})}),(e,t)=>{const s=j,u=D;return d(),k(F,null,[m(s,{modelValue:i(o).name,"onUpdate:modelValue":t[0]||(t[0]=a=>i(o).name=a),type:"text",name:"text",label:"",placeholder:"请输入名称"},null,8,["modelValue"]),m(u,{value:i(o).violation_type,"onUpdate:value":t[1]||(t[1]=a=>i(o).violation_type=a),columns:l.value,label:"",placeholder:"请选择违章类型"},null,8,["value","columns"]),m(u,{value:i(o).status,"onUpdate:value":t[2]||(t[2]=a=>i(o).status=a),placeholder:"状态",columns:c.value},null,8,["value","columns"])],64)}}}),H=g({__name:"ViolationRecord",setup(y){O();const{routerPush:r}=S(),n=f({name:"",start_date:"",end_state:"",status:"",violation_type:""}),p=[{title:"违章名称",className:"three",key:"violation_event"},{title:"违章类型",className:"three",key:"treeselect_8"},{title:"违章地点",className:"three",key:"violation_place"},{title:"状态",className:"three",key:"status"},{title:"操作",key:"action"}];async function l({pageNum:e}={pageNum:1}){const t={page:e,...n.value},s=await J(t);return{total:Number(s.count)||0,data:s.data||[]}}function c(e){r("task-process",{fid:0,tid:0,transid:e.process_inst_id,task_id:e.id})}function o(e){const t=[{label:"事件名称",value:e.violation_event},{label:"违章类型",value:e.treeselect_8},{label:"违章地点",value:e.violation_place},{label:"违章时间",value:e.violation_time},{label:"违章人",value:e.uid_user_name},{label:"处理人",value:e.violation_personnel_user_name},{label:"违章人",value:e.violation_personnel_user_name},{label:"所属部门",value:e.violation_personnel_department_id_depart_name.length>0?e.violation_personnel_department_id_depart_name:"-"},{label:"处理人",value:e.uid_user_name},{label:"违章罚款",value:e.punishment_amount},{label:"处理状态",value:K.trans("job_status_list",e.process_status)}];r("institutionalizedDetail",{detail:JSON.stringify(t)})}return(e,t)=>{const s=$,u=B;return d(),N(u,{columns:p,request:l,onOnRowClick:o,form:i(n),"onUpdate:form":t[1]||(t[1]=a=>h(n)?n.value=a:null),floating:[{icon:"search",key:"search"}]},{"cell-status":_(({row:a})=>{var b;return[z("div",null,M(((b=a==null?void 0:a.statusObj)==null?void 0:b.label)||""),1)]}),"cell-action":_(({row:a})=>[m(s,{type:"primary",class:"text-12px",size:"small",onClick:P(b=>c(a),["stop"])},{default:_(()=>[...t[2]||(t[2]=[T(" 查看 ",-1)])]),_:1},8,["onClick"])]),searchForm:_(()=>[m(G,{form:i(n),"onUpdate:form":t[0]||(t[0]=a=>h(n)?n.value=a:null)},null,8,["form"])]),_:1},8,["form"])}}}),I=g({__name:"TemplateSearchForm",props:{form:{default:()=>({})},dataKey:{default:{year:"implement_year",obj_id:"obj_id"}}},emits:["update:form"],setup(y,{emit:r}){const n=y,p=r,l=f([]),c=f([{text:"公开",value:2},{text:"私有",value:1}]),o=U({...n.form});return x(o,e=>{p("update:form",e)},{deep:!0}),x(()=>n.form,e=>{Object.assign(o,e)},{deep:!0,immediate:!0}),w(()=>{R({is_node:"0",id:"914682",deep:1,enbase:1}).then(e=>{l.value=e.map(t=>({text:t.title,value:t.node_id}))})}),(e,t)=>{const s=j,u=D;return d(),k(F,null,[m(s,{modelValue:i(o).name,"onUpdate:modelValue":t[0]||(t[0]=a=>i(o).name=a),type:"text",name:"text",label:"",placeholder:"请输入名称"},null,8,["modelValue"]),m(u,{value:i(o).private,"onUpdate:value":t[1]||(t[1]=a=>i(o).private=a),placeholder:"状态",columns:c.value},null,8,["value","columns"])],64)}}}),Q={key:0},W={key:1},X=g({__name:"ViolationTemplate",setup(y){const r=O(),{routerPush:n}=S(),p=[{title:"违章名称",key:"name",width:"20%"},{title:"状态",key:"private",width:"10%"},{title:"制作人",key:"user",width:"20%"},{title:"发布时间",key:"created_at",width:"20%"},{title:"操作",className:"two",key:"action"}],l=f({tpl:1,formid:59,start_date:"",end_date:"",private:"",name:"",status:"",set_etp_id:""});async function c({pageNum:t}={pageNum:1}){const{etp_groups:s}=r.userInfo;console.warn(s);const u={page:t,...l.value},a=await A(u);return{total:Number(a.count)||0,data:a.data||[]}}function o(t){n("task-process",{task_id:0,app_id:13,tid:t.id})}const e=[{icon:"search",key:"search"}];return(t,s)=>{var b;const u=$,a=B;return d(),N(a,{columns:p,request:c,form:i(l),"onUpdate:form":s[1]||(s[1]=v=>h(l)?l.value=v:null),floating:e},q({"cell-private":_(({row:v})=>[v.private==="1"?(d(),k("span",Q,"私有")):(d(),k("span",W,"公开"))]),searchForm:_(()=>[m(I,{form:i(l),"onUpdate:form":s[0]||(s[0]=v=>h(l)?l.value=v:null)},null,8,["form"])]),_:2},[(b=i(r))!=null&&b.getPri("violation-regulations",2)?{name:"cell-action",fn:_(({row:v})=>[m(u,{type:"primary",class:"text-12px",size:"small",onClick:ee=>o(v)},{default:_(()=>[...s[2]||(s[2]=[T(" 调用 ",-1)])]),_:1},8,["onClick"])]),key:"0"}:void 0]),1032,["form"])}}}),Y={class:"flex-center h-[100vh] w-100% items-center"},Z=g({__name:"index",setup(y){const r=f("publicTemplate");L("violation-tab",l=>{r.value=l.name});const n=V(()=>({violationTemplate:X,violationRecord:H})),p=V(()=>n.value[r.value]||null);return(l,c)=>(d(),k("div",Y,[(d(),N(E(p.value)))]))}});typeof C=="function"&&C(Z);export{Z as default};
